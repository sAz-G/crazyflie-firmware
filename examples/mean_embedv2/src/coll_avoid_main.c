/**
 * ,---------,       ____  _ __
 * |  ,-^-,  |      / __ )(_) /_______________ _____  ___
 * | (  O  ) |     / __  / / __/ ___/ ___/ __ `/_  / / _ \
 * | / ,--Â´  |    / /_/ / / /_/ /__/ /  / /_/ / / /_/  __/
 *    +------`   /_____/_/\__/\___/_/   \__,_/ /___/\___/
 *
 * Crazyflie control firmware
 *
 * Copyright (C) 2019 Bitcraze AB
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, in version 3.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 *
 * hello_world.c - App layer application of a simple hello world debug print every
 *   2 seconds.
 */


#include <string.h>
#include <stdint.h>
#include <stdbool.h>

#include "app.h"

#include "FreeRTOS.h"
#include "task.h"

#include "debug.h"
#include "radiolink.h"
#include "param.h"
#include "log.h"
#include "configblock.h"
#include "stabilizer_types.h"
#include "commander.h"
#include "estimator_kalman.h"
#include "stabilizer.h"
#include "math3d.h"
#include "../include/coll_avoid_main.h"
#include "motors.h"

#define NGHBRS 6
#define NGHBRSDIM 6 
#define NDRNS 8


void networkEvaluate(control_t_n* control_n, const float* state_array);
int main_nn(float *outdatav);
Vector3 getPosition(void);
Vector3 getVeloc(void);
float clip(float val, float min, float max);

float linear(float num) {
	return num;
}


float sigmoid(float num) {
	return 1 / (1 + exp(-num));
}


float relu(float num) {
	if (num > 0) {
		return num;
	} else {
		return 0;
	}
}

static const int structure [6][2] = {{6, 8},{8, 8},{18, 16},{16, 16},{24, 32},{32, 4}};


static const int NEIGHBORS = NGHBRS;
static const int NBR_DIM = NGHBRSDIM; 
static const int NUMQUADS = NDRNS; 
static int farthestNeighb = 0;
static int lastAdded = 1;
static int timer = 0;
static PacketData ownPacket;
uint8_t highlvl = 0;

static float output_0[8];
static float output_1[8];
static float output_2[16];
static float output_3[16];
static float inputff[24];
static float output_4[32];
static float output_5[4];


static float mototrKValue = 1.0f;
static float thrusts[4]   = {0.f, 0.f, 0.f, 0.f};
static uint16_t thrustsInt[4];
static uint16_t thrustsToMotor[4];
static float dronesInfo[NDRNS][NGHBRSDIM];
static float kNearestArr[NGHBRS][NGHBRSDIM];
static float ownTarget[3] = {.0f, 0.f, .5f};
static struct mat33 rot;
static float state_array[18];
static int state = 0;

//static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[6][8]  = {{0.4817355275154114,-0.13560867309570312,-0.5717208981513977,-0.4451223611831665,-0.20544274151325226,0.9114608764648438,-0.09513801336288452,-0.432461142539978},{-0.3405008316040039,-0.8471822738647461,-0.2063400149345398,-0.3396919369697571,-0.03659500554203987,-0.7406834959983826,0.6632750034332275,0.0907977744936943},{0.22729414701461792,0.9578796029090881,0.16322074830532074,-0.960584819316864,0.1553315967321396,-0.12060192227363586,-0.15556170046329498,-0.4137076437473297},{0.03710112348198891,-0.3495730757713318,-0.7615658044815063,0.4963882863521576,-0.16626104712486267,0.29007843136787415,0.19772472977638245,0.1019504964351654},{0.000918674748390913,0.07690513879060745,-0.3546372354030609,0.4120495021343231,0.3575204312801361,0.09811306744813919,-0.014858439564704895,-0.016313539817929268},{0.04230943322181702,0.5551528334617615,-0.3784674406051636,0.18690985441207886,0.1466807723045349,0.36179810762405396,-0.7853116393089294,0.5242552161216736}};
//static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8]  = {{-0.5959084630012512,0.537564218044281,0.23057174682617188,0.6393026113510132,0.14313368499279022,0.5566742420196533,0.21864642202854156,0.616031289100647},{-0.07711222022771835,0.528014063835144,-0.1280953288078308,-0.3708931803703308,-0.2840973436832428,-0.21220925450325012,-0.5873594284057617,0.14380255341529846},{-0.012332472018897533,-0.10992599278688431,-0.026796724647283554,-0.13250276446342468,-0.17291583120822906,-0.060947902500629425,0.3948761820793152,-0.382690966129303},{-0.016652826219797134,-0.6258770227432251,-0.3382711410522461,0.7551614046096802,0.3431469202041626,0.5049160122871399,-0.4043446481227875,-0.4650599956512451},{0.15692123770713806,0.2767969071865082,0.3293270468711853,-0.3646138608455658,-0.2640354633331299,-0.44092419743537903,-0.15506252646446228,-0.39232906699180603},{0.31990769505500793,0.5702754855155945,-0.27274268865585327,0.6209384202957153,0.22681574523448944,0.5122143626213074,0.24482029676437378,0.050971101969480515},{-0.22394955158233643,-0.7446122765541077,-0.5572765469551086,0.2927525043487549,0.2508552074432373,-0.3430320620536804,0.01953967660665512,-0.10196293145418167},{-0.23379656672477722,-0.6271827220916748,-0.36671432852745056,-0.49165141582489014,-0.3710065484046936,-0.5316808819770813,0.243482768535614,0.48218733072280884}};
//static const float actor_encoder_self_encoder_0_weight[18][16]                  = {{-0.031018933281302452,-0.04903430491685867,0.15254446864128113,-0.17913265526294708,-0.2090536504983902,0.1397654265165329,0.08791153132915497,-0.02507159113883972,0.02542395144701004,0.13249771296977997,-0.27527710795402527,-0.021920954808592796,-0.50102299451828,-0.2713545858860016,-0.24709907174110413,-0.2133326232433319},{-0.03944525495171547,0.16252681612968445,0.25536733865737915,-0.12730365991592407,-0.10948043316602707,-0.07375466078519821,-0.17340639233589172,-0.02538568153977394,0.06766553968191147,-0.0891268327832222,0.234083890914917,0.21642336249351501,0.3791351318359375,-0.3258776366710663,0.22442001104354858,0.00990526657551527},{0.3922114968299866,0.12814433872699738,0.2134581208229065,-0.5444064140319824,-0.35901790857315063,-0.03841125965118408,-0.01203202735632658,0.13333822786808014,-0.32681530714035034,-0.508092999458313,0.345683217048645,-0.14994221925735474,-0.05070125311613083,0.13618351519107819,-0.42810532450675964,-0.35333868861198425},{0.056069254875183105,-0.22816234827041626,0.24036358296871185,-0.15716475248336792,0.08038957417011261,0.012697269208729267,0.4084399342536926,-0.3508729934692383,0.003424266818910837,-0.036326270550489426,0.10144544392824173,-0.17787659168243408,-0.2825414538383484,-0.09991493076086044,0.2673330307006836,-0.17535635828971863},{0.03861524909734726,0.10562614351511002,-0.11921524256467819,-0.19730789959430695,-0.3321033716201782,0.09528689086437225,-0.2931520342826843,-0.029306726530194283,0.1583172082901001,-0.13977831602096558,0.009136865846812725,0.22037191689014435,0.20775820314884186,-0.1293354332447052,-0.0027840123511850834,-0.41208943724632263},{0.33524200320243835,-0.26048025488853455,-0.09759555011987686,-0.032430510967969894,-0.04446733370423317,-0.1300787627696991,0.05449928343296051,-0.3470839560031891,-0.23064318299293518,-0.29110226035118103,0.1783038228750229,-0.32536637783050537,-0.1799236536026001,0.22393248975276947,0.16437728703022003,-0.27050480246543884},{0.11711446940898895,-0.1258123368024826,0.16250896453857422,-0.18029563128948212,0.3239893317222595,0.12332002073526382,0.256883829832077,-0.30046331882476807,-0.3181847631931305,0.03628160059452057,0.0722464844584465,0.3217572867870331,0.002917048754170537,0.09881971031427383,-0.30693548917770386,0.25277644395828247},{0.02697838470339775,0.2504666745662689,0.39444875717163086,-0.21513211727142334,-0.4401679039001465,0.031072843819856644,0.3542817234992981,0.5514721870422363,-0.09998580068349838,0.10344146192073822,-0.17872074246406555,0.21242599189281464,0.019770853221416473,0.34160709381103516,0.13164523243904114,-0.23803898692131042},{0.2394406646490097,-0.15171650052070618,0.29815375804901123,-0.4332188069820404,-0.0012124853674322367,0.5013760328292847,-0.17313611507415771,0.3228587210178375,-0.09212997555732727,0.09453337639570236,0.07867120206356049,0.24171297252178192,-0.32538920640945435,-0.42803066968917847,-0.06397418677806854,0.0159323550760746},{0.2968144416809082,0.3437310457229614,-0.16263751685619354,0.051475267857313156,0.4368680715560913,0.4318280816078186,-0.167356476187706,0.20004792511463165,-0.512752115726471,-0.2352786809206009,-0.02886922098696232,-0.059609897434711456,-0.04780206084251404,-0.0701831579208374,-0.29234814643859863,0.1359100639820099},{-0.17139914631843567,-0.09296843409538269,-0.08397351205348969,-0.1175970807671547,0.051025159657001495,-0.06336159259080887,-0.2174803912639618,0.27598100900650024,-0.16536591947078705,0.4251788258552551,0.045256610959768295,-0.4424797296524048,0.3530897796154022,-0.16620957851409912,-0.013847378082573414,-0.33231186866760254},{0.18395113945007324,0.36291930079460144,-0.005687751341611147,-0.08617047220468521,-0.06327944248914719,-0.46663686633110046,-0.265582412481308,-0.14549235999584198,-0.4600701630115509,-0.5091957449913025,-0.2957649230957031,0.49282634258270264,0.40294361114501953,0.07093401253223419,0.42463579773902893,-0.20922042429447174},{-0.2059803605079651,0.3471727967262268,-0.16837596893310547,0.2542533576488495,0.25999897718429565,-0.0844656378030777,-0.45792055130004883,-0.3957977592945099,-0.3887403905391693,-0.27680596709251404,0.32771727442741394,0.3081904947757721,0.28374847769737244,-0.22696730494499207,0.14184372127056122,-0.3293233811855316},{-0.30533987283706665,0.08182192593812943,0.04253539443016052,0.5268346667289734,0.5582253336906433,-0.47837522625923157,-0.052291139960289,-0.07123744487762451,-0.28536421060562134,-0.17407917976379395,-0.1866806000471115,-0.2882325351238251,-0.08508660644292831,0.5992736220359802,-0.01917940191924572,-0.185867041349411},{-0.09102647006511688,-0.007819305174052715,0.2031240165233612,0.15793175995349884,-0.04472079873085022,-0.1456081122159958,-0.16399610042572021,0.3234143853187561,-0.015227220021188259,0.004656542558223009,-0.14309394359588623,0.11619250476360321,-0.15662279725074768,-0.08433963358402252,0.0515391007065773,0.1229427233338356},{0.25190526247024536,0.21381859481334686,0.1122342124581337,0.31126174330711365,0.2533721923828125,-0.23220396041870117,-0.13910165429115295,0.2518374025821686,0.12007841467857361,-0.22699442505836487,-0.5210142731666565,-0.2716669738292694,-0.4021501839160919,0.13896948099136353,0.38785022497177124,0.4194444417953491},{0.1925029456615448,-0.39574089646339417,0.10620646178722382,0.018625933676958084,0.01757287234067917,0.17314857244491577,0.2788996696472168,-0.035961247980594635,-0.06657253205776215,-0.2632625699043274,-0.13805240392684937,-0.05296865105628967,-0.19174353778362274,0.22087235748767853,0.04860702529549599,0.22568705677986145},{0.24109598994255066,0.31148117780685425,-0.3288581073284149,0.15982182323932648,0.42955267429351807,0.303905189037323,-0.1399422585964203,-0.20917631685733795,-0.11545847356319427,0.2571240961551666,0.03249222785234451,0.10040269792079926,-0.035825204104185104,-0.07280854135751724,0.1706901490688324,0.6073858141899109}};
//static const float actor_encoder_self_encoder_2_weight[16][16]                  = {{-0.17250661551952362,0.0889984741806984,-0.24515597522258759,-0.19764800369739532,0.2909010946750641,-0.19199366867542267,-0.10222907364368439,0.41541433334350586,0.12563671171665192,-0.40470975637435913,-0.12067455053329468,-0.2949649393558502,0.45388394594192505,-0.0015194342704489827,0.30957117676734924,0.2061644047498703},{-0.40640512108802795,0.35793381929397583,-0.24684923887252808,-0.1172795444726944,-0.41060420870780945,-0.21257536113262177,0.02050808258354664,0.29498976469039917,0.29302746057510376,0.017761114984750748,-0.23668894171714783,0.18330058455467224,-0.2787834703922272,0.13991650938987732,0.10345380008220673,-0.18596354126930237},{0.0888807475566864,-0.30275553464889526,0.1735355406999588,0.27632400393486023,-0.11041759699583054,0.46552643179893494,0.0070717716589570045,-0.13338987529277802,0.10531497001647949,-0.07214398682117462,0.2403702288866043,-0.20237760245800018,-0.01301000826060772,-0.3930271863937378,-0.18435509502887726,0.19870996475219727},{0.1024332195520401,0.4014759063720703,0.052408263087272644,-0.1879507452249527,-0.23142942786216736,-0.13611003756523132,-0.35622185468673706,-0.2634810209274292,0.20033450424671173,0.30908912420272827,-0.027617255225777626,-0.21813839673995972,-0.29534661769866943,0.08819543570280075,0.158548966050148,0.19414089620113373},{0.0814201608300209,-0.25255391001701355,0.010223421268165112,-0.42988690733909607,-0.5807251334190369,-0.12318094074726105,-0.5235942602157593,0.03855597972869873,-0.02092882990837097,0.1804092973470688,0.03424849361181259,0.09791869670152664,-0.02030067704617977,-0.21939344704151154,-0.039427418261766434,-0.32754161953926086},{-0.33803531527519226,-0.34806182980537415,0.39754578471183777,-0.13857319951057434,-0.3479989767074585,0.06504280865192413,-0.1920766979455948,0.2704809010028839,-0.3762766122817993,-0.09869308024644852,0.26790493726730347,-0.34844082593917847,0.4127301275730133,-0.028452180325984955,-0.11550237983465195,-0.3622928857803345},{-0.18043045699596405,0.12071052938699722,-0.348723828792572,-0.23548050224781036,0.32379165291786194,-0.12675881385803223,0.0647234246134758,-0.3075388967990875,-0.29624032974243164,-0.02479284442961216,0.39523473381996155,-0.06745459139347076,0.24996452033519745,0.427751749753952,-0.23439264297485352,-0.11337732523679733},{0.15513093769550323,0.18262724578380585,-0.09435965120792389,-0.15206101536750793,0.03886943310499191,0.27752068638801575,0.0439235158264637,0.060054436326026917,-0.23063316941261292,-0.07910410314798355,0.30557745695114136,-0.33123284578323364,0.06854013353586197,-0.23930047452449799,-0.00019569748837966472,0.38006070256233215},{0.22487369179725647,-0.09054054319858551,0.20287296175956726,-0.043103788048028946,0.24283254146575928,0.21410825848579407,-0.1424015760421753,-0.21900248527526855,-0.07948135584592819,0.38774004578590393,0.2950858175754547,0.04460710659623146,-0.16905875504016876,-0.004669711925089359,-0.30529600381851196,0.3380647599697113},{-0.15777696669101715,0.2665688693523407,0.28937703371047974,-0.3152084946632385,-0.3377033770084381,-0.19028475880622864,-0.03787771612405777,0.27432575821876526,0.19502855837345123,-0.02033669501543045,0.30304232239723206,-0.028121573850512505,0.001100241905078292,-0.28021931648254395,-0.22405558824539185,-0.03661588206887245},{-0.15390601754188538,0.17228122055530548,-0.02498406358063221,0.0006829328485764563,0.0001096387641155161,0.04022059962153435,-0.014795215800404549,0.359122097492218,-0.04798692464828491,-0.3054373562335968,-0.3174360692501068,-0.08917464315891266,-0.10444783419370651,-0.0022412159014493227,-0.06270250678062439,-0.250919371843338},{-0.02296174131333828,-0.130048006772995,0.3571440577507019,0.15426407754421234,0.19902624189853668,0.18165729939937592,-0.0596613809466362,-0.26043063402175903,-0.3600124716758728,-0.46049946546554565,-0.0010644645662978292,-0.10696038603782654,-0.2517651319503784,0.24917830526828766,0.1828596293926239,-0.304826557636261},{-0.11721901595592499,0.3995817005634308,-0.3433155417442322,0.305083304643631,0.37115639448165894,-0.3768242299556732,0.04011200740933418,-0.1125350147485733,0.0204269178211689,0.08747289329767227,-0.20950114727020264,-0.14046664535999298,0.0489540696144104,0.278864324092865,0.37557658553123474,-0.3038928508758545},{-0.25557997822761536,0.2609767019748688,-0.2995114028453827,-0.24900829792022705,-0.22332797944545746,0.029881911352276802,0.23508913815021515,0.3324137032032013,-0.16076722741127014,-0.20213507115840912,0.11362850666046143,0.24780720472335815,-0.3030807673931122,-0.15258252620697021,-0.28515228629112244,-0.1999421864748001},{0.34838876128196716,0.4181590676307678,0.011147022247314453,0.25158408284187317,0.040047332644462585,-0.1994689255952835,0.3118886649608612,-0.23504847288131714,-0.13778957724571228,-0.1889900416135788,-0.2885737717151642,-0.08995108306407928,0.2276245802640915,0.469139039516449,0.13142390549182892,0.039011139422655106},{-0.07356281578540802,-0.23650743067264557,-0.2990363538265228,0.1445603221654892,-0.3646031320095062,-0.390095591545105,0.16991962492465973,-0.17337985336780548,0.07972879707813263,0.32810887694358826,-0.001167416456155479,0.45443686842918396,-0.3221272826194763,-0.040742237120866776,-0.30759114027023315,-0.11725423485040665}};
//static const float actor_encoder_feed_forward_0_weight[24][32]                  = {{0.165548637509346,0.2863088846206665,0.25215497612953186,0.12970474362373352,-0.008611702360212803,0.3127811849117279,0.3362376391887665,0.02276952750980854,0.03173055499792099,-0.2194308340549469,0.31947627663612366,0.20037449896335602,0.2654592990875244,-0.13967829942703247,0.15952168405056,-0.1808711141347885,-0.24828848242759705,0.043776705861091614,-0.03911830857396126,-0.06535740196704865,0.12547625601291656,-0.23809941112995148,-0.31449705362319946,-0.0500149205327034,0.030889352783560753,0.12548162043094635,-0.12845245003700256,0.1591419279575348,0.13616429269313812,-0.21391630172729492,-0.08126413077116013,-0.09454455971717834},{0.10724244266748428,-0.36988675594329834,0.31596237421035767,0.05644363909959793,-0.21064728498458862,0.09332821518182755,-0.1861274540424347,0.08249673992395401,0.13890492916107178,0.1827639937400818,0.1324959248304367,-0.06755716353654861,0.1718844175338745,0.035731468349695206,0.3248232305049896,0.07967253029346466,-0.2919883728027344,-0.23905497789382935,0.20125198364257812,-0.3231845498085022,-0.29991504549980164,-0.1495707482099533,-0.010350492782890797,0.26666611433029175,0.06596096605062485,0.08277302980422974,0.24573102593421936,0.20131726562976837,-0.08756325393915176,-0.07334188371896744,0.09724805504083633,0.03765656799077988},{0.27436503767967224,-0.031712763011455536,-0.02549358457326889,0.11505627632141113,0.0865129679441452,0.24583351612091064,0.06279155611991882,0.3309038281440735,0.15425051748752594,-0.16288535296916962,-0.2692001461982727,0.2031647264957428,-0.13454708456993103,0.13544270396232605,-0.09974756836891174,-0.03478757292032242,-0.21628043055534363,-0.07981083542108536,-0.20498496294021606,-0.20400811731815338,0.3430643677711487,0.04806828498840332,0.02611469104886055,-0.3057570457458496,-0.2009945809841156,0.1275230050086975,0.3314143717288971,-0.12756310403347015,-0.1600898653268814,-0.16161461174488068,-0.24524830281734467,-0.28623801469802856},{0.22792023420333862,0.09849434345960617,-0.16491901874542236,0.041439238935709,-0.09856481105089188,-0.3204212188720703,0.10968124121427536,0.14832302927970886,0.2456941306591034,-0.13705943524837494,0.13303597271442413,0.05818861350417137,-0.15914416313171387,-0.308947890996933,0.15198442339897156,-0.23179073631763458,-0.15308114886283875,0.00026592938229441643,0.17576047778129578,0.22774146497249603,0.03277329355478287,0.07782016694545746,0.15015819668769836,0.06069754809141159,0.0688459649682045,0.17961066961288452,0.12088212370872498,0.11258804798126221,0.014808318577706814,0.17815731465816498,0.17827467620372772,0.09133456647396088},{-0.18519777059555054,-0.17564691603183746,0.2757846713066101,0.176356241106987,-0.18318016827106476,-0.2491452693939209,0.33072927594184875,-0.24760065972805023,-0.21251113712787628,0.154563307762146,-0.07734250277280807,-0.21711365878582,0.16731035709381104,0.09444442391395569,0.35504263639450073,-0.06921830773353577,0.2214304506778717,0.2581084370613098,-0.2506134510040283,0.29292625188827515,0.23286135494709015,0.3239833116531372,0.1375671774148941,0.0017259785672649741,0.09393451362848282,-0.1713894009590149,0.13952156901359558,0.16546617448329926,-0.084422767162323,0.21307718753814697,-0.09201539307832718,-0.03154789283871651},{0.0823935866355896,0.07131874561309814,0.09303906559944153,-0.2637554109096527,0.19461362063884735,-0.18300369381904602,0.1795007586479187,0.2143208235502243,0.0040171449072659016,-0.05647912621498108,0.22000724077224731,0.2711363434791565,-0.2980113625526428,-0.41725847125053406,-0.25611427426338196,-0.16077129542827606,-0.19125449657440186,0.2890952527523041,-0.1443784534931183,-0.022767379879951477,-0.09139111638069153,0.02156052179634571,0.25931262969970703,-0.19771763682365417,-0.12104329466819763,0.12639622390270233,-0.15556883811950684,-0.1232658177614212,0.1050044521689415,-0.19642023742198944,-0.04650557041168213,-0.22416220605373383},{-0.10965277999639511,-0.29638734459877014,-0.1336819976568222,0.03711295872926712,-0.14338186383247375,0.053498275578022,0.08067284524440765,-0.39322036504745483,0.17291009426116943,0.13896812498569489,-0.24080245196819305,0.015470600686967373,-0.2528306245803833,-0.007644972298294306,-0.10945814102888107,-0.1533440500497818,-0.04444938898086548,0.04363715648651123,-0.25738197565078735,-0.00965855922549963,0.012498913332819939,0.03381204232573509,0.11729078739881516,-0.08625461161136627,0.17951764166355133,0.245568186044693,-0.026811307296156883,0.10035119950771332,0.18334798514842987,0.156536266207695,-0.11607272177934647,-0.07332448661327362},{-0.11725279688835144,-0.286172479391098,-0.1668238639831543,0.13050031661987305,-0.26799362897872925,-0.19263318181037903,-0.20886389911174774,0.13047218322753906,-0.27210965752601624,0.08933649957180023,-0.36854952573776245,0.14060112833976746,-0.030159419402480125,0.09960952401161194,-0.12262926995754242,-0.1727864146232605,0.09377150982618332,0.06880615651607513,-0.2936023771762848,0.029818834736943245,0.2441614270210266,0.2858980596065521,-0.06211226060986519,0.22608768939971924,-0.15902680158615112,-0.22461548447608948,0.004316249396651983,0.03565507009625435,-0.0530521459877491,-0.16918298602104187,-0.1827777624130249,0.2208535522222519},{-0.12896020710468292,-0.008873126469552517,0.24044182896614075,0.329866498708725,0.0093692597001791,0.23599034547805786,-0.2139102965593338,-0.0066005573607981205,0.159515842795372,0.19857275485992432,-0.2926354706287384,-0.23563821613788605,-0.16484299302101135,-0.24533888697624207,-0.2570897936820984,0.22992412745952606,0.27538126707077026,0.12150809168815613,0.005843081511557102,-0.3449860215187073,0.19480308890342712,0.14923633635044098,0.18441163003444672,-0.11301806569099426,0.2031986117362976,-0.002508623991161585,0.17489606142044067,0.20576941967010498,-0.27203819155693054,0.11148462444543839,0.12748217582702637,0.13444072008132935},{-0.16381113231182098,0.08636856079101562,-0.09233440458774567,-0.16748683154582977,0.3252894878387451,0.14175501465797424,-0.23956142365932465,-0.23794423043727875,0.005350511986762285,0.13866020739078522,0.2751087546348572,0.049992356449365616,0.3267776370048523,-0.172355055809021,0.08228051662445068,0.03972657397389412,0.281791627407074,-0.17538729310035706,0.35882970690727234,-0.07569841295480728,-0.11999750882387161,-0.22076457738876343,-0.0741015300154686,-0.23171047866344452,-0.03998527303338051,0.3354595899581909,0.088467538356781,-0.11364720016717911,0.09320942312479019,-0.11709617078304291,0.028492745012044907,0.027418794110417366},{-0.3113839626312256,0.035113248974084854,-0.20888164639472961,-0.017513202503323555,0.015149656683206558,-0.232638880610466,0.17157532274723053,0.07198678702116013,0.15597319602966309,0.1285368651151657,0.30877092480659485,-0.17370952665805817,-0.1012643352150917,0.045435525476932526,-0.2536003887653351,0.29559969902038574,-0.23107211291790009,0.24954786896705627,0.09535152465105057,-0.06491445749998093,-0.17130796611309052,-0.3232060372829437,0.25904718041419983,-0.1683199554681778,-0.05297330766916275,0.13881313800811768,-0.13569782674312592,0.06286526471376419,0.2682991623878479,-0.018691154196858406,-0.10870005935430527,-0.16262207925319672},{0.1874050348997116,0.15401604771614075,0.046143606305122375,-0.22684596478939056,-0.2622026205062866,-0.08599621802568436,0.009133309125900269,-0.23319940268993378,0.04436742514371872,0.23195414245128632,-0.2663395404815674,0.13576093316078186,0.2038508802652359,0.054147738963365555,-0.030442601069808006,-0.2170075625181198,-0.027500025928020477,-0.08648991584777832,0.08367019146680832,-0.21757885813713074,-0.03430845960974693,0.014513397589325905,-0.09031491726636887,-0.007272348739206791,0.13192543387413025,0.11008887737989426,0.13439561426639557,-0.028848757967352867,0.11911813169717789,-0.24170894920825958,0.05113131180405617,-0.11078318953514099},{0.01040643360465765,0.0834556519985199,-0.3466234505176544,-0.24925559759140015,0.30890801548957825,-0.0619460754096508,0.27517640590667725,0.23284220695495605,-0.06175446882843971,-0.3038301467895508,-0.23459933698177338,-0.04799797758460045,0.09751888364553452,-0.005497129634022713,-0.30149388313293457,0.2707671523094177,-0.10772768408060074,0.0780109167098999,0.23576250672340393,0.23100461065769196,0.31667208671569824,0.08490587770938873,-0.04070252925157547,0.20310159027576447,0.2578403353691101,-0.18349520862102509,-0.033983856439590454,-0.3385297656059265,-0.28302058577537537,-0.1637103110551834,-0.20023596286773682,-0.2867584228515625},{0.11127010732889175,0.1594184935092926,-0.1995050013065338,0.12938497960567474,0.19505029916763306,-0.1499605029821396,-0.17156079411506653,-0.17076338827610016,0.024450218304991722,-0.33732059597969055,0.05705626308917999,-0.18800385296344757,-0.010643498972058296,0.07786644250154495,-0.009816890582442284,0.021439742296934128,0.14095064997673035,0.11550642549991608,-0.06664092093706131,-0.26522693037986755,0.07462213933467865,-0.09229639917612076,0.0097115533426404,-0.3451831340789795,-0.20731838047504425,0.21786530315876007,0.3366422951221466,0.14566241204738617,0.033996231853961945,-0.1014770045876503,0.2651338577270508,-0.11861586570739746},{0.03289090096950531,-0.33300450444221497,-0.006742897909134626,-0.2401239275932312,0.026354771107435226,0.10656540095806122,-0.13285860419273376,0.10333292186260223,0.19626285135746002,-0.00897903461009264,0.3006244897842407,-0.10394925624132156,0.09940297156572342,-0.07917380332946777,0.16626550257205963,0.1808050274848938,0.3006635010242462,0.21040140092372894,-0.2205318957567215,-0.15963660180568695,-0.12227382510900497,-0.06963489204645157,-0.01714373007416725,0.2722946107387543,0.15577369928359985,0.060592491179704666,0.15703119337558746,-0.08864322304725647,-0.035611771047115326,0.057188730686903,0.26321426033973694,0.03319592773914337},{-0.16451941430568695,0.2363359034061432,-0.040906209498643875,0.19931820034980774,0.2559571862220764,-0.07403424382209778,0.09996965527534485,-0.166115865111351,-0.16841603815555573,-0.23478102684020996,-0.23961296677589417,-0.16764913499355316,-0.15912282466888428,-0.18113450706005096,-0.34105053544044495,0.20675739645957947,0.14159511029720306,-0.2710351347923279,0.15022560954093933,-0.19345740973949432,-0.35944560170173645,-0.1633337140083313,-0.14771142601966858,0.0335647389292717,0.16719548404216766,0.2135811299085617,0.3494219183921814,0.1898880898952484,0.08042045682668686,0.11813060939311981,-0.12203775346279144,-0.04885008931159973},{0.05108208954334259,0.24015122652053833,0.01623171754181385,-0.06791720539331436,0.05025094375014305,0.05409659445285797,0.20795758068561554,-0.16106016933918,-0.04420057684183121,0.06671446561813354,0.01671139895915985,0.12671683728694916,-0.3547048568725586,0.03500550240278244,-0.160459503531456,0.03125905618071556,0.17769359052181244,-0.09621760249137878,-0.06746950000524521,-0.03611309826374054,-0.39141646027565,0.18918481469154358,-0.17234016954898834,0.22564226388931274,0.09332600980997086,-0.1931188851594925,-0.005840154830366373,-0.12597179412841797,-0.08645574003458023,0.2654884457588196,0.20262573659420013,0.013344173319637775},{-0.15591377019882202,-0.128669872879982,-0.14534057676792145,0.3299470543861389,-0.4347221553325653,-0.3337540030479431,-0.11046314239501953,-0.11232433468103409,0.20619674026966095,-0.024736450985074043,-0.3035750985145569,0.007601420395076275,0.19695492088794708,0.1767333745956421,-0.200413778424263,0.1477925330400467,-0.16282257437705994,-0.1868227869272232,-0.05075287073850632,-0.11003486812114716,-0.05250418931245804,-0.005278231110423803,-0.025008762255311012,0.13344211876392365,0.10998823493719101,-0.31699517369270325,0.015205707401037216,0.23226039111614227,0.06722836941480637,0.13346225023269653,-0.009568422101438046,-0.18206016719341278},{-0.018369710072875023,0.03307707980275154,0.3265568017959595,-0.013196245767176151,-0.03829047083854675,-0.1954893171787262,-0.14823678135871887,0.24619384109973907,0.29129156470298767,0.1433715522289276,0.053809475153684616,-0.20577949285507202,-0.11733820289373398,0.2059842050075531,0.1779368817806244,-0.006099057849496603,0.060088980942964554,0.322083979845047,0.2729654908180237,0.12952262163162231,-0.16625364124774933,-0.12427526712417603,0.03680907562375069,-0.0021447534672915936,-0.05699565261602402,0.41147923469543457,0.24759812653064728,0.02048170194029808,0.19809693098068237,-0.1382169872522354,-0.1194630041718483,0.30120643973350525},{-0.2508203387260437,-0.0040075574070215225,0.14787627756595612,0.23887626826763153,0.2819255292415619,-0.12083324044942856,0.03220931440591812,-0.1415688693523407,0.11456670612096786,-0.1489858478307724,-0.029080918058753014,-0.08918736129999161,-0.08647201955318451,-0.0598665326833725,-0.11096388101577759,0.33895447850227356,-0.09137587249279022,-0.30187809467315674,-0.01913377083837986,-0.22660183906555176,0.0641394779086113,-0.2130356729030609,0.08035159111022949,-0.04396592453122139,-0.25478485226631165,0.36272433400154114,-0.27635622024536133,-0.32356950640678406,-0.275719553232193,0.271860271692276,0.21952290832996368,-0.11324106156826019},{0.19763913750648499,-0.044437624514102936,0.23569418489933014,0.11076456308364868,0.23312298953533173,-0.12902583181858063,-0.04482070729136467,-0.1991724818944931,-0.2047891616821289,0.15898965299129486,-0.25481483340263367,-0.20602335035800934,0.24491390585899353,0.24307216703891754,-0.15319444239139557,0.10999148339033127,-0.041535742580890656,0.18074436485767365,0.028506888076663017,0.0028836631681770086,-0.23803813755512238,0.08621937781572342,0.18509534001350403,-0.2628064751625061,0.06637653708457947,0.1549668163061142,0.05563608556985855,0.23010507225990295,-0.1707807332277298,-0.001014758599922061,-0.10636614263057709,-0.3405689001083374},{-0.22256752848625183,-0.16131265461444855,0.15767745673656464,0.06319500505924225,0.31293684244155884,0.321688711643219,0.004779264330863953,0.20264387130737305,-0.005469420459121466,0.20849038660526276,0.2556661069393158,-0.0988365188241005,-0.04690715670585632,0.2076721340417862,0.2167155146598816,-0.24180470407009125,-0.14936423301696777,0.3242211937904358,0.06310476362705231,0.07124941051006317,0.2059716135263443,-0.1572391837835312,-0.1387719213962555,-0.288663774728775,-0.21469390392303467,-0.12167241424322128,-0.15897098183631897,-0.05558052286505699,0.24297082424163818,-0.21661150455474854,0.17400451004505157,-0.24424317479133606},{0.08964931219816208,-0.3432861566543579,-0.15643619000911713,0.1268729716539383,-0.26045921444892883,-0.12774024903774261,-0.16180415451526642,0.06743454188108444,0.21741072833538055,0.2696287930011749,0.08737099915742874,-0.23755435645580292,0.1766425222158432,0.2841125428676605,-0.06271103024482727,0.15894083678722382,-0.11907529830932617,0.17651639878749847,-0.25185924768447876,0.29328206181526184,0.17644304037094116,-0.007613664958626032,0.2506958246231079,0.15697301924228668,-0.2234710156917572,-0.12652888894081116,0.23774513602256775,0.10041920840740204,-0.2136567234992981,-0.24136000871658325,-0.1489487737417221,-0.2742682695388794},{-0.21799984574317932,-0.06833849102258682,-0.10232584923505783,-0.02437206730246544,-0.11290857940912247,-0.13509680330753326,-0.1609487235546112,0.006706795655190945,-0.174944207072258,-0.057572972029447556,-0.23434339463710785,-0.34318867325782776,0.09329453110694885,-0.22771386802196503,-0.15267828106880188,0.11536100506782532,0.18455344438552856,0.2956324815750122,-0.2884601056575775,-0.05938486009836197,-0.07776924967765808,0.08762295544147491,0.29202598333358765,0.047139037400484085,0.06637320667505264,-0.2635205090045929,0.2032393366098404,-0.2275843322277069,-0.0759054496884346,0.01802334003150463,-0.2235298901796341,-0.040121618658304214}};
//static const float action_parameterization_distribution_linear_weight[32][4]    = {{0.0018238559132441878,-0.01863468810915947,-0.020803678780794144,-0.026661641895771027},{0.2304447740316391,-0.003921112045645714,0.24846939742565155,0.23613014817237854},{-0.19012326002120972,0.10261399298906326,-0.0011009230511263013,0.04405145347118378},{0.2036546766757965,0.01578429341316223,-0.05993053317070007,-0.048721276223659515},{0.0937611311674118,0.040163833647966385,0.12224852293729782,-0.08174875378608704},{0.29192858934402466,0.17036843299865723,0.1942616105079651,0.13665315508842468},{-0.2827511727809906,-0.09268619865179062,-0.14438261091709137,-0.3329290449619293},{0.003854658454656601,-0.2581993341445923,0.14426621794700623,-0.34784233570098877},{-0.24502643942832947,0.18561801314353943,0.28998690843582153,0.280564546585083},{0.167038694024086,0.10391206294298172,-0.20045974850654602,-0.21710984408855438},{0.20467443764209747,0.28798913955688477,-0.1788179874420166,0.17192621529102325},{-0.015466689132153988,0.2556988000869751,0.18293997645378113,-0.29969799518585205},{0.10072669386863708,0.210373193025589,0.04475509375333786,-0.3559015691280365},{0.19216634333133698,-0.02324710041284561,0.2389482706785202,-0.14128609001636505},{-0.32563474774360657,-0.1258542835712433,0.04180607944726944,0.20543111860752106},{0.11665858328342438,-0.103118397295475,-0.04057904705405235,0.10901924222707748},{-0.35756999254226685,-0.3036474585533142,0.2791370749473572,-0.335074245929718},{-0.020006848499178886,0.02300744503736496,0.021364882588386536,-0.03290761262178421},{0.19527409970760345,0.005405698902904987,0.062245819717645645,0.12917029857635498},{-0.050760846585035324,-0.1879386007785797,-0.07814856618642807,-0.1432333141565323},{-0.00594307528808713,-0.1559974104166031,-0.1347922533750534,-0.046704795211553574},{0.05272557586431503,-0.15034478902816772,-0.24249476194381714,0.14947637915611267},{-0.24699966609477997,0.1492871642112732,0.020183563232421875,-0.05043866112828255},{0.0312159713357687,-0.038376495242118835,-0.035607099533081055,0.06463071703910828},{0.2648259401321411,-0.09162598848342896,-0.19003906846046448,-0.27472394704818726},{-0.005158130545169115,-0.004294442944228649,0.21303342282772064,0.19884023070335388},{0.20693710446357727,0.16277194023132324,0.13944527506828308,0.07538390159606934},{-0.1370844542980194,0.14822208881378174,-0.07148536294698715,-0.20331621170043945},{0.288482666015625,-0.18595167994499207,-0.11398273706436157,-0.09148010611534119},{-0.19049377739429474,0.12724553048610687,0.10406583547592163,-0.1625024378299713},{0.1467801183462143,-0.18909673392772675,-0.0037006584461778402,-0.2738551199436188},{0.01607166975736618,0.18357835710048676,0.08695054799318314,0.009601542726159096}};
//static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8]       = {-0.0006142810452729464,-0.01616438291966915,0.016026800498366356,0.0046602534130215645,0.00025187782011926174,0.03468603640794754,0.018035709857940674,-0.007819494232535362};
//static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8]       = {-0.03183240070939064,-0.030890202149748802,0.05673544108867645,-0.055397383868694305,-0.001579359988681972,0.025896364822983742,0.0014418907230719924,0.01388280838727951};
//static const float actor_encoder_self_encoder_0_bias[16]                        = {0.022532669827342033,0.03233788534998894,-0.11665879935026169,0.046988703310489655,-0.12139256298542023,-0.03376997262239456,-0.02049664407968521,-0.040222786366939545,-0.03284257650375366,-0.13422290980815887,0.0617852583527565,0.015856033191084862,-0.05088035762310028,-0.01473409403115511,0.043574973940849304,-0.050338953733444214};
//static const float actor_encoder_self_encoder_2_bias[16]                        = {-0.03972839564085007,-0.010516771115362644,-0.027183569967746735,0.0034269350580871105,0.01453594584017992,-0.004183739423751831,-0.03482261672616005,0.03780607879161835,-0.053133148699998856,0.00911560095846653,-0.10481216013431549,0.06142324581742287,-0.043996818363666534,0.004994465969502926,0.045559898018836975,0.012189256027340889};
//static const float actor_encoder_feed_forward_0_bias[32]                        = {-0.013435188680887222,0.05415460094809532,-0.030157512053847313,-0.026860270649194717,0.009520728141069412,-0.014130333438515663,-0.03752212971448898,0.046036671847105026,0.024855196475982666,0.01238095760345459,-0.015266450121998787,0.014718047343194485,0.03026280738413334,0.018908832222223282,0.0460311621427536,-0.013249906711280346,-0.00245852442458272,0.017190726473927498,0.007895594462752342,0.009437396191060543,0.003434461075812578,0.026211563497781754,-0.008385134860873222,0.015415524132549763,-0.02472931146621704,0.005269660148769617,0.004701168276369572,-0.03262000530958176,0.008149600587785244,-0.004086395259946585,-0.013967584818601608,0.011040610261261463};
//static const float action_parameterization_distribution_linear_bias[4]          = {-0.00826839916408062,-0.022956326603889465,0.01663227565586567,0.0095604183152318};

static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[6][8] = {{0.21359284222126007,-0.4538440406322479,-0.2422761619091034,-0.5552499890327454,-0.03918301314115524,-0.36220425367355347,-0.032879799604415894,0.8212265372276306},{0.5609453320503235,-0.23872090876102448,-0.40244340896606445,0.874248743057251,0.8317944407463074,-0.397484689950943,0.05349314957857132,0.2969242334365845},{-0.2041160762310028,0.16554142534732819,0.4680391550064087,0.3058367669582367,-0.12677958607673645,0.6079744100570679,0.32356739044189453,0.1230030357837677},{-0.02884783409535885,-0.11779415607452393,0.47405141592025757,-0.25106486678123474,-0.22970028221607208,0.05460777133703232,0.0032763113267719746,-0.023268748074769974},{-0.07154734432697296,-0.26773878931999207,0.4318738579750061,0.27663111686706543,0.04820935055613518,-0.5664815306663513,0.224876269698143,-0.156062051653862},{0.552703857421875,0.21211561560630798,0.22866329550743103,-0.05584863945841789,0.1783255785703659,-0.30069684982299805,0.18963570892810822,-0.18775871396064758}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{-0.5495797991752625,0.08843397349119186,-0.09142577648162842,-0.1522008627653122,0.11858966946601868,-0.4249255061149597,0.47647035121917725,-0.08108936995267868},{-0.20631779730319977,-0.6059369444847107,0.14184914529323578,0.2073555290699005,-0.0045618582516908646,0.20819319784641266,0.25239837169647217,-0.19219662249088287},{0.5385321974754333,-0.4897637367248535,0.24545995891094208,0.3716098368167877,0.12931479513645172,-0.23101522028446198,0.06264469027519226,-0.04783981665968895},{-0.5686181783676147,-0.32159873843193054,0.04316963627934456,-0.10211721062660217,0.448222279548645,0.2838703989982605,-0.4258054792881012,-0.7581176161766052},{0.36119577288627625,0.0776732787489891,0.16968803107738495,0.4273620843887329,-0.5455344915390015,-0.011514242738485336,0.1261296272277832,-0.6287807822227478},{0.16812220215797424,-0.5987513065338135,-0.5506699681282043,-0.3428089916706085,0.11186440289020538,0.2874908149242401,0.1036437451839447,0.04798097535967827},{-0.32798632979393005,0.6131054162979126,0.08510614186525345,0.03984559699892998,-0.3660063147544861,0.2982746660709381,-0.24377533793449402,0.3775854706764221},{-0.13174445927143097,0.2836715877056122,-0.5421534180641174,-0.3647713363170624,-0.48485371470451355,0.006681948900222778,-0.6229231357574463,-0.15560099482536316}};
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3534250259399414,0.07726674526929855,0.417980432510376,-0.4704107642173767,-0.12585657835006714,0.05679035559296608,-0.36289361119270325,0.0762062817811966,-0.28458666801452637,0.21932971477508545,-0.021251104772090912,0.11808915436267853,0.33391472697257996,-0.0921730026602745,0.3918190896511078,0.08977065980434418},{0.37024006247520447,0.3018256723880768,-0.10385818034410477,-0.14570274949073792,0.36486196517944336,0.07899606972932816,-0.3159993290901184,-0.22725865244865417,0.3146916329860687,-0.11718521267175674,-0.3941173553466797,0.11135893315076828,0.1506274789571762,-0.46852797269821167,-0.26415228843688965,0.09436849504709244},{0.013292369432747364,-0.16876456141471863,-0.2889740467071533,0.03231971710920334,0.22380557656288147,-0.07408387959003448,0.23471152782440186,0.359333872795105,-0.647071123123169,0.3363908529281616,0.2322816103696823,-0.020493997260928154,0.009624381549656391,-0.3000594675540924,-0.40266841650009155,0.4297749102115631},{-0.19871731102466583,0.16598393023014069,0.27001896500587463,-0.3840053379535675,-0.10266510397195816,0.024324286729097366,-0.2617097496986389,-0.18603472411632538,0.15058009326457977,0.18916288018226624,-0.024257803335785866,0.15787649154663086,0.24676325917243958,-0.17241720855236053,-0.256512314081192,-0.0038137834053486586},{-0.08001365512609482,0.214518740773201,-0.11695513129234314,0.08993449807167053,0.28871551156044006,0.06845496594905853,0.08776462078094482,-0.11941234022378922,0.1534181535243988,0.0989588126540184,-0.23234812915325165,0.39085525274276733,0.22539474070072174,-0.4548881947994232,0.046435531228780746,0.12514914572238922},{-0.2997112572193146,-0.22607704997062683,0.22639696300029755,0.3129741847515106,0.029969388619065285,0.2570953667163849,0.16354037821292877,-0.07537820190191269,-0.3102550208568573,-0.08851766586303711,0.46403440833091736,-0.07637099921703339,0.015932561829686165,0.06517067551612854,-0.12483134120702744,0.012192751280963421},{-0.043773259967565536,-0.38628560304641724,-0.09830756485462189,-0.2850930988788605,0.09269536286592484,0.6702038049697876,-0.33950334787368774,0.10630761086940765,0.3328753709793091,0.25525933504104614,0.27684226632118225,0.39873969554901123,-0.2653537690639496,0.22605262696743011,0.25265246629714966,0.0012686612317338586},{0.21413207054138184,-0.23604175448417664,0.08626111596822739,0.2871570289134979,0.14201965928077698,0.7322676777839661,-0.2417631596326828,0.029389210045337677,-0.2439723014831543,-0.34768232703208923,-0.2984673082828522,-0.11719312518835068,0.5113348960876465,0.037843745201826096,0.03822537511587143,0.005533345974981785},{0.6047992706298828,0.5136471390724182,0.18159551918506622,-0.2703622281551361,-0.4026038348674774,0.08715210855007172,-0.32022881507873535,0.2782062590122223,-0.4647549092769623,0.48093143105506897,-0.041232023388147354,0.0379103347659111,-0.014969379641115665,0.17695258557796478,0.12516158819198608,-0.04941307753324509},{-0.4279153645038605,0.031377166509628296,-0.027873843908309937,0.008757147938013077,0.4234614670276642,-0.22309470176696777,0.1135760247707367,0.08632385730743408,-0.08248553425073624,-0.054246824234724045,-0.007896700873970985,-0.07376251369714737,-0.7731735706329346,0.21417850255966187,-0.02607044018805027,-0.5163037180900574},{-0.16482242941856384,-0.24814386665821075,-0.038578275591135025,-0.1007436066865921,0.43460842967033386,0.5526248216629028,-0.1452643722295761,0.1517864316701889,-0.11206987500190735,0.2686925232410431,-0.1253616064786911,0.3147825002670288,-0.05386589840054512,-0.4286360740661621,-0.08920839428901672,-0.19434146583080292},{-0.27333641052246094,0.46354976296424866,-0.07144460827112198,0.25647348165512085,0.21419116854667664,0.21980541944503784,0.1964554488658905,-0.2624400556087494,-0.6992827653884888,-0.316272109746933,-0.26092857122421265,0.18174248933792114,-0.06656765192747116,-0.8178752660751343,-0.34097522497177124,-0.05939096212387085},{0.6763637065887451,0.15110674500465393,0.1015172079205513,-0.9188718199729919,-0.20992127060890198,-0.5509308576583862,-0.026164576411247253,0.18511687219142914,-0.024064576253294945,0.24611282348632812,0.42230087518692017,-0.5926126837730408,0.17308703064918518,0.0958852544426918,-0.38884493708610535,-0.03177782520651817},{-0.42281752824783325,0.36795201897621155,0.648375928401947,-0.37371617555618286,0.13977517187595367,0.17495188117027283,-0.25579172372817993,0.31746190786361694,-0.01612223871052265,-0.10146515816450119,0.039513472467660904,0.4191775619983673,-0.04374619945883751,-0.5443557500839233,-0.3215138912200928,-0.14023026823997498},{-0.2865420877933502,0.2845189869403839,0.3754703998565674,0.3340763449668884,0.26411694288253784,0.04195328429341316,0.14419177174568176,-0.09918195754289627,0.3281373381614685,0.31327465176582336,-0.049800507724285126,-0.1505766361951828,0.11832842975854874,0.5148211121559143,0.20689557492733002,-0.3635033071041107},{-0.13895216584205627,0.08705727010965347,-0.07646014541387558,-0.21345657110214233,-0.11257860064506531,0.33262789249420166,-0.30907297134399414,-0.33789345622062683,-0.18095549941062927,0.17954444885253906,-0.07397397607564926,0.10906399041414261,-0.29679253697395325,-0.0662384033203125,-0.06735779345035553,0.21174213290214539},{-0.14245207607746124,0.2031826674938202,-0.37740829586982727,0.16097643971443176,0.14668475091457367,0.1465432047843933,0.06152570620179176,-0.2858341932296753,-0.11733689904212952,-0.05336018279194832,-0.2731805443763733,0.2625782787799835,-0.11169824749231339,-0.19140799343585968,0.30148082971572876,0.20679698884487152},{-0.24722373485565186,0.08447127789258957,-0.23638245463371277,-0.25486236810684204,-0.29227980971336365,0.20874382555484772,0.28337496519088745,0.40186595916748047,0.08014392852783203,-0.3381381332874298,0.044775865972042084,-0.4662988483905792,-0.12199926376342773,-0.23520979285240173,-0.1595245599746704,0.37710708379745483}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{-0.3885616958141327,-0.2744065821170807,0.1980816274881363,-0.2438502460718155,-0.25967827439308167,-0.09545441716909409,-0.0024363757111132145,-0.43402352929115295,-0.10483679920434952,0.10249875485897064,-0.26287841796875,0.3811351954936981,-0.4168294668197632,-0.05034565553069115,-0.39028608798980713,-0.1172165647149086},{-0.31634700298309326,0.3380756974220276,0.25588080286979675,0.03337842598557472,0.2572733163833618,0.31165292859077454,-0.17036586999893188,0.06350328773260117,-0.32693296670913696,0.26890385150909424,0.4533606171607971,-0.42257627844810486,-0.009110450744628906,0.0003613849403336644,0.08166279643774033,-0.4257141649723053},{-0.4540056586265564,0.09978191554546356,0.046384043991565704,-0.006192916538566351,-0.45144882798194885,0.32885318994522095,0.2410029172897339,-0.4696181118488312,-0.18796280026435852,-0.6052156090736389,0.262057363986969,0.1833745688199997,0.19751760363578796,0.3988628387451172,-0.2962345480918884,-0.1986641138792038},{0.15938425064086914,0.29899677634239197,-0.200739786028862,-0.30197635293006897,-0.10934766381978989,-0.09135977923870087,-0.20752204954624176,-0.0356515571475029,-0.13711878657341003,-0.14055584371089935,-0.3138270974159241,-0.11020679026842117,-0.22524958848953247,-0.47601833939552307,0.3476177155971527,-0.08832971006631851},{0.0395568385720253,0.3979641795158386,-0.30672508478164673,0.4436046779155731,-0.13794894516468048,-0.1060829907655716,-0.09276895970106125,0.07024907320737839,-0.056439608335494995,-0.4303164780139923,-0.28581130504608154,0.20091144740581512,0.11253814399242401,-0.1548215001821518,0.1883871853351593,0.24094869196414948},{0.39224573969841003,-0.22522921860218048,-0.31985199451446533,0.22213895618915558,0.18856821954250336,-0.08251402527093887,0.286557674407959,-0.11342005431652069,-0.4376828670501709,0.20398560166358948,0.014633170329034328,0.2805575132369995,0.09931007772684097,0.012998311780393124,-0.2333219349384308,0.462505042552948},{-0.4314756989479065,0.26383551955223083,0.19337664544582367,-0.16759121417999268,-0.43949130177497864,0.10939858108758926,-0.22956666350364685,0.33666521310806274,0.36648568511009216,-0.09395009279251099,-0.4297545850276947,-0.33618423342704773,-0.32593441009521484,0.2723313570022583,0.25131452083587646,-0.15169256925582886},{-0.08215215802192688,-0.29226383566856384,-0.14536376297473907,-0.16141639649868011,-0.23494823276996613,-0.011788399890065193,0.15802615880966187,-0.4831354320049286,-0.06327017396688461,-0.3876495957374573,-0.10730694979429245,0.207676962018013,-0.36775270104408264,0.37225428223609924,-0.13123708963394165,-0.16491907835006714},{-0.31161826848983765,-0.21394199132919312,0.11643809825181961,-0.161671444773674,-0.45695748925209045,-0.055025044828653336,-0.20452089607715607,0.06387282907962799,0.029224831610918045,-0.34092220664024353,0.3951490819454193,0.34484606981277466,-0.21331840753555298,-0.19157738983631134,0.32839885354042053,0.08136077970266342},{-0.41811028122901917,-0.21046264469623566,-0.364452600479126,0.31266626715660095,-0.12052824348211288,0.012908926233649254,-0.26793333888053894,-0.30493712425231934,0.15293531119823456,-0.012073494493961334,-0.24686414003372192,0.011214877478778362,-0.1962244063615799,0.41634616255760193,0.023079795762896538,0.07075020670890808},{-0.19379331171512604,-0.09691057354211807,0.02040240913629532,-0.24099215865135193,-0.04284270852804184,0.12071165442466736,0.12769731879234314,0.01605209708213806,0.18129824101924896,0.07015062123537064,-0.4427391588687897,0.05351095274090767,0.21623383462429047,0.26290538907051086,-0.12469232827425003,0.11682100594043732},{0.12180135399103165,0.16313773393630981,0.06592673808336258,0.24838222563266754,0.005950933787971735,-0.15926577150821686,-0.3297647535800934,-0.028229113668203354,-0.15026022493839264,-0.0647910088300705,-0.21126292645931244,-0.3025228977203369,-0.006435283925384283,0.18848814070224762,0.2577943503856659,-0.5053821802139282},{-0.2653299570083618,-0.5126988291740417,-0.13214918971061707,-0.3006887435913086,-0.3330136239528656,0.20238910615444183,-0.06904324144124985,-0.4593100845813751,0.2092605084180832,-0.2223382294178009,-0.36993950605392456,0.17108987271785736,-0.4563855826854706,0.01727914623916149,-0.04825844243168831,0.4157928228378296},{0.17286276817321777,-0.19922979176044464,-0.05929545313119888,0.026038488373160362,0.0806557908654213,-0.20447225868701935,-0.11452075839042664,0.3567599356174469,0.5411444902420044,-0.7064991593360901,0.2011350393295288,0.3098343014717102,-0.4423161447048187,0.39850670099258423,0.12643969058990479,-0.3207634389400482},{-0.11049460619688034,-0.10825607180595398,0.42100790143013,0.38347405195236206,0.09984496980905533,-0.2974390685558319,-0.20513169467449188,-0.330783873796463,-0.08383559435606003,0.17500410974025726,0.033921487629413605,-0.17781127989292145,-0.05540448799729347,-0.173259437084198,0.04481162503361702,0.06644108891487122},{0.4017496705055237,0.1049027070403099,0.021925097331404686,-0.1424691379070282,-0.40738800168037415,0.15207724273204803,0.2212950587272644,0.22935320436954498,0.27554306387901306,-0.0016296695685014129,-0.012777735479176044,0.36258450150489807,0.06530029326677322,0.3024411201477051,-0.022172922268509865,0.23302680253982544}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.19461052119731903,0.056877247989177704,-0.24224303662776947,0.26091188192367554,-0.22231532633304596,-0.32796964049339294,0.008964316919445992,0.19411705434322357,-0.032863616943359375,-0.11279745399951935,0.10933259129524231,-0.23642447590827942,-0.27901768684387207,0.275662362575531,-0.3781944215297699,-0.21543096005916595,0.08989056199789047,-0.2677547037601471,-0.07198852300643921,-0.20497703552246094,0.03253944590687752,0.08030612766742706,-0.04645492509007454,0.025024015456438065,0.03463730961084366,0.056614238768815994,-0.2867126166820526,0.05865861847996712,0.05579885467886925,-0.0162382610142231,-0.21879607439041138,-0.09164180606603622},{-0.09984598308801651,-0.20026984810829163,-0.14990420639514923,0.08878029137849808,0.14346739649772644,0.08860400319099426,0.26664772629737854,-0.09146999567747116,-0.12322571873664856,-0.05682675167918205,-0.13654257357120514,0.028781283646821976,0.09622664004564285,-0.06662015616893768,-0.28310516476631165,-0.19058673083782196,-0.035045988857746124,0.09583230316638947,0.11202244460582733,-0.12390211969614029,0.11439646780490875,-0.03763112053275108,-0.336473673582077,0.135341614484787,-0.3509056866168976,0.1531098186969757,0.16093769669532776,-0.13861872255802155,0.08292470127344131,-0.04531075805425644,-0.35486727952957153,0.1898549646139145},{-0.1648063361644745,-0.3503730297088623,0.11369967460632324,0.07409750670194626,-0.07024341076612473,-0.2270684540271759,0.06341268122196198,0.1814458668231964,-0.27516865730285645,-0.024797482416033745,0.20441442728042603,-0.31475716829299927,0.36231815814971924,0.5259224772453308,0.3739628195762634,0.2074117213487625,-0.3124798834323883,-0.26072219014167786,-0.04524599760770798,-0.07158614695072174,0.3293212056159973,-0.06440984457731247,0.0015230379067361355,0.19497258961200714,-0.19789256155490875,0.01790681853890419,0.16029857099056244,0.4285334050655365,-0.008951032534241676,-0.1217624768614769,0.29179203510284424,-0.3411955237388611},{-0.15768371522426605,-0.05830875039100647,0.07556614279747009,0.15583139657974243,-0.22433140873908997,0.10764829069375992,0.09593585133552551,-0.19954854249954224,-0.2924821078777313,-0.10227660834789276,-0.3143378794193268,0.15048813819885254,0.19766759872436523,0.09889410436153412,-0.2900354862213135,-0.33037254214286804,0.245106041431427,0.018151897937059402,0.23303265869617462,0.2093912959098816,0.18986837565898895,-0.0367894172668457,0.22773118317127228,0.06496896594762802,-0.31001409888267517,-0.23046725988388062,0.055308979004621506,-0.516303300857544,-0.07466351240873337,-0.1494801938533783,-0.27605530619621277,0.25218629837036133},{-0.05306254327297211,-0.05104398727416992,0.11926301568746567,-0.03750409558415413,-0.007445452269166708,-0.08115163445472717,-0.03417307883501053,0.33636385202407837,0.21504007279872894,0.23895014822483063,-0.08465056121349335,0.28234612941741943,0.04062993824481964,-0.17767301201820374,-0.042945001274347305,0.17876781523227692,0.0738745704293251,-0.10325227677822113,0.05908995121717453,-0.12916764616966248,0.27779027819633484,0.01625952124595642,0.07424505054950714,0.10913487523794174,-0.06479988992214203,-0.2819474935531616,0.17914988100528717,-0.14924608170986176,0.0047095827758312225,-0.20538654923439026,0.11283093690872192,-0.31633806228637695},{-0.11325497925281525,-0.30399468541145325,-0.09611065685749054,0.09832947701215744,-0.0959358960390091,-0.2048647403717041,0.12585128843784332,0.3162052035331726,0.0533708818256855,0.109437495470047,0.17777742445468903,-0.3917675316333771,0.31599190831184387,-0.37022387981414795,-0.10322622209787369,0.2119116634130478,-0.5441847443580627,0.1045469269156456,0.2954944968223572,-0.19696246087551117,0.06476984918117523,0.029416993260383606,0.27031001448631287,0.01644034869968891,0.05005830526351929,0.26857468485832214,0.25446397066116333,-0.10943977534770966,-0.21039411425590515,-0.06183155998587608,0.009905766695737839,0.005441408138722181},{0.04009167477488518,0.4436381459236145,-0.2277158498764038,-0.08230908960103989,0.12487833946943283,-0.14245152473449707,-0.4024001955986023,-0.3001016080379486,0.11593784391880035,0.10985561460256577,0.014932435937225819,-0.21962392330169678,-0.3343122601509094,0.29174235463142395,0.20177797973155975,-0.1572120189666748,-0.3234846293926239,0.23667676746845245,-0.04937693104147911,0.07148120552301407,-0.13744838535785675,0.40165409445762634,0.37937113642692566,-0.2135636955499649,-0.1653520166873932,-0.19623368978500366,0.08377000689506531,-0.286823034286499,0.32322970032691956,0.04472333565354347,-0.2982521951198578,0.2673443853855133},{0.272849977016449,0.06182616949081421,-0.11786273121833801,-0.22512798011302948,0.1827925592660904,-0.05392330512404442,0.042984213680028915,-0.24438026547431946,-0.08762146532535553,-0.2254742532968521,-0.03337986394762993,-0.03678378462791443,0.1959330439567566,0.11881524324417114,-0.3668193221092224,0.2824750244617462,-0.21466903388500214,0.12383738905191422,0.04743233695626259,-0.1650446504354477,-0.12951892614364624,0.14846393465995789,0.019565019756555557,-0.2679748833179474,-0.33841416239738464,0.02104545757174492,-0.4652434289455414,0.17080633342266083,0.0764058381319046,0.15316392481327057,-0.1681666076183319,0.28196170926094055},{0.10208062082529068,0.11287785321474075,-0.32243064045906067,0.056419458240270615,-0.026988014578819275,0.16072838008403778,-0.09424721449613571,-0.22576084733009338,0.004400860518217087,0.15681542456150055,-0.032774318009614944,-0.15087126195430756,0.2520895302295685,-0.09759649634361267,-0.18486015498638153,0.13320724666118622,-0.06921970844268799,-0.17267446219921112,0.20452506840229034,0.07766612619161606,-0.13561247289180756,-0.04527578502893448,-0.024781880900263786,0.27656620740890503,-0.18317483365535736,0.15241841971874237,-0.2530003786087036,0.05841534584760666,0.3085894286632538,-0.04397831857204437,0.04642275720834732,0.030164310708642006},{0.2831608057022095,0.1347329020500183,0.23103877902030945,0.21643513441085815,0.1838257908821106,0.08165993541479111,-0.02316923253238201,0.18230023980140686,-0.044431209564208984,0.10016248375177383,-0.4352608025074005,-0.31625181436538696,-0.24399550259113312,0.20968790352344513,-0.3013242781162262,-0.003179778577759862,-0.34281080961227417,-0.3854557275772095,-0.15370045602321625,-0.09753827005624771,0.01485303696244955,-0.09749197959899902,-0.12132380157709122,0.2667151689529419,-0.07884868234395981,-0.09600774943828583,-0.019537808373570442,0.0017721571493893862,0.056521572172641754,-0.2175867259502411,-0.2025488317012787,0.20348505675792694},{0.1224827691912651,0.13170874118804932,-0.10812146961688995,0.3283030688762665,-0.07807023078203201,-0.13730184733867645,-0.23137427866458893,0.05420616269111633,0.11549648642539978,0.1981012523174286,0.2146415114402771,0.30565178394317627,0.09249532222747803,0.3972783386707306,-0.2578221261501312,-0.099828340113163,0.23078963160514832,-0.17780181765556335,-0.07266586273908615,0.24272632598876953,0.18307079374790192,0.006181804463267326,0.29485756158828735,-0.018994459882378578,0.0524061843752861,-0.2282409518957138,0.21322758495807648,-0.10583138465881348,0.04441776126623154,-0.3167046904563904,0.5109444260597229,-0.022457163780927658},{0.22005271911621094,0.030378803610801697,-0.262067049741745,0.03464255481958389,-0.3036474585533142,-0.09639362245798111,-0.29820090532302856,-0.05480392649769783,-0.010265481658279896,-0.19261205196380615,-0.018681460991501808,0.06398794054985046,-0.12576942145824432,-0.1455061137676239,-0.2437625676393509,-0.08019480109214783,-0.12179265916347504,0.0036801164969801903,-0.19143570959568024,-0.0966583788394928,0.10859706997871399,0.100344717502594,-0.23968303203582764,0.19974219799041748,-0.17552517354488373,0.2900458872318268,0.19638870656490326,-0.09681309759616852,0.08388817310333252,-0.21109101176261902,0.19750341773033142,0.1323513239622116},{-0.18476112186908722,-0.2838776409626007,-0.2107222080230713,-0.16233383119106293,-0.21885012090206146,-0.18131689727306366,0.11594337224960327,0.2719374895095825,-0.04772855341434479,-0.022080300375819206,0.0031431163661181927,0.040896426886320114,0.11507648229598999,0.2793082892894745,-0.03093312308192253,0.0004258581029716879,0.14734618365764618,0.2527995705604553,-0.23888397216796875,-0.004437741357833147,0.32248517870903015,-0.08275798708200455,-0.19004924595355988,0.02949903905391693,0.3207506537437439,-0.16151395440101624,0.10246938467025757,-0.31471291184425354,-0.1216079592704773,0.3150947391986847,-0.08469383418560028,0.06584306061267853},{0.2884197235107422,0.121070496737957,-0.34443485736846924,-0.01335216499865055,-0.11826781928539276,-0.021728960797190666,-0.18864770233631134,-0.09364890307188034,0.22155550122261047,0.03867294639348984,0.01886858232319355,-0.253030925989151,-0.2511328160762787,-0.10959390550851822,0.07663438469171524,-0.06318675726652145,-0.15233229100704193,0.04332450032234192,0.3370204567909241,-0.11375899612903595,-0.13187894225120544,-0.27107366919517517,0.2972175180912018,0.25652939081192017,0.2540724575519562,0.13496997952461243,-0.1965978443622589,-0.057901781052351,0.04751688987016678,-0.23250150680541992,-0.08482175320386887,0.2865670621395111},{0.21421627700328827,-0.44724419713020325,-0.10659050196409225,-0.10843051970005035,-0.27635326981544495,0.1848239004611969,-0.09756279736757278,0.23629997670650482,-0.26666340231895447,-0.06917595118284225,-0.09926780313253403,0.3733595609664917,-0.10521595180034637,-0.002986542647704482,0.02147107571363449,-0.21427784860134125,0.13194353878498077,0.28494319319725037,-0.4027917683124542,0.23385794460773468,-0.15754421055316925,0.003153331344947219,-0.054083436727523804,-0.031558889895677567,-0.4115334749221802,0.18985821306705475,0.07217995077371597,-0.053454723209142685,-0.11546199768781662,0.03896775841712952,0.27361369132995605,-0.12110703438520432},{-0.09736993163824081,0.4374749958515167,0.11575237661600113,-0.14281922578811646,-0.12694567441940308,0.14255954325199127,-0.1478073000907898,-0.3675565719604492,0.012970583513379097,0.3239792287349701,-0.29494786262512207,0.15167967975139618,0.04323858767747879,0.044581636786460876,-0.13327009975910187,-0.2111225426197052,0.08023712038993835,-0.3092591464519501,0.1393834352493286,0.37263453006744385,0.29482582211494446,0.32975444197654724,-0.16634710133075714,-0.22434920072555542,-0.27892929315567017,0.23817148804664612,-0.356035441160202,0.11336040496826172,0.35587987303733826,0.22422552108764648,0.32114049792289734,-0.011892815120518208},{0.027175305411219597,-0.1871354579925537,-0.04182055592536926,-0.18879130482673645,0.21450357139110565,-0.3061821162700653,0.009842859581112862,0.16484011709690094,-0.08618702739477158,0.3644618093967438,-0.29477396607398987,0.27538326382637024,0.10899697989225388,-0.22918370366096497,0.23818092048168182,0.14042158424854279,-0.1441250592470169,0.0626954436302185,-0.1811639964580536,0.09115377813577652,0.028531186282634735,-0.23498991131782532,-0.06950987130403519,-0.21742279827594757,0.32026761770248413,0.31557825207710266,0.10550098121166229,-0.21420705318450928,-0.133165180683136,-0.39514586329460144,-0.01822419837117195,-0.2301657646894455},{0.2608407735824585,0.10710453987121582,-0.3830670714378357,0.16437844932079315,-0.09481792896986008,-0.08786045014858246,0.08314672112464905,0.009425905533134937,-0.1546410769224167,-0.11234217882156372,-0.34347793459892273,-0.00258095795288682,0.18346841633319855,0.18770956993103027,0.16786962747573853,0.11346480250358582,0.12699277698993683,-0.06305723637342453,-0.533643901348114,-0.6369206309318542,0.5204338431358337,0.052866287529468536,-0.07038255035877228,-0.23128823935985565,0.033275943249464035,-0.07959013432264328,-0.020714882761240005,-0.12216213345527649,-0.05946109816431999,-0.28415969014167786,-0.07231801748275757,-0.09195601940155029},{-0.05406060814857483,-0.017492733895778656,0.3066718280315399,0.048467427492141724,0.272430419921875,-0.22832264006137848,-0.026445548981428146,-0.19808970391750336,0.1632586419582367,-0.06893949210643768,-0.10598283261060715,-0.223267063498497,0.061270684003829956,0.12994210422039032,-0.21225981414318085,-0.09707599133253098,0.11051196604967117,0.15202127397060394,-0.03212489187717438,-0.19676199555397034,-0.08218906074762344,0.0008236995781771839,-0.18091389536857605,0.1651851236820221,0.2442353069782257,-0.3100966215133667,-0.07870098203420639,0.19454404711723328,-0.029026081785559654,-0.20465725660324097,0.2732033133506775,-0.1105380430817604},{-0.1251528114080429,0.10137900710105896,0.3169664144515991,-0.1478351354598999,-0.15637388825416565,0.06281770765781403,0.2636268734931946,0.10349104553461075,0.3150130808353424,-0.4536561071872711,0.2675026059150696,0.34401825070381165,-0.1895202398300171,0.15359178185462952,-0.06924524903297424,-0.026105066761374474,-0.14731107652187347,0.24275226891040802,0.04964258149266243,-0.05098668485879898,0.16415508091449738,-0.3911008834838867,0.07671841979026794,-0.016422512009739876,0.06116802245378494,-0.2729967534542084,-0.09466942399740219,0.1805967390537262,-0.07481292635202408,0.058882344514131546,0.21957577764987946,0.23994730412960052},{0.15790288150310516,-0.13163667917251587,0.014656874351203442,0.3125695586204529,0.16176246106624603,-0.556624174118042,0.2520136833190918,-0.24860505759716034,-0.1791282445192337,-0.04249386861920357,-0.28165820240974426,0.06559905409812927,0.14282670617103577,-0.07616302371025085,-0.10412314534187317,-0.1417488306760788,0.056889697909355164,-0.09326943010091782,-0.23689933121204376,0.041143257170915604,-0.015199114568531513,0.121737040579319,0.24728238582611084,0.1320130079984665,-0.053378596901893616,-0.14638057351112366,-0.17450344562530518,0.1986864060163498,0.19627419114112854,-0.41363587975502014,0.10835951566696167,0.0242310743778944},{-0.061278462409973145,0.22438175976276398,0.04732323810458183,-0.18532654643058777,-0.032266490161418915,0.1324205994606018,0.2061547487974167,-0.09459012746810913,0.14860732853412628,-0.01649726927280426,-0.1659657508134842,0.16149041056632996,-0.09562577307224274,0.06981444358825684,0.32919609546661377,0.16227522492408752,0.03468608856201172,0.363923579454422,0.031764429062604904,-0.34774070978164673,0.1503862738609314,-0.3707873225212097,0.11976567655801773,0.18007631599903107,0.11228245496749878,0.2907021641731262,-0.11685367673635483,-0.2646051049232483,-0.05963515117764473,-0.07667925953865051,0.09508496522903442,0.11103826016187668},{-0.026572518050670624,0.15120252966880798,-0.17258763313293457,0.03571747615933418,-0.04520302638411522,-0.2494121491909027,0.4080396294593811,-0.13859610259532928,-0.055179499089717865,-0.12075801938772202,0.2602895498275757,0.23212940990924835,0.056893132627010345,-0.10440827161073685,-0.030596768483519554,0.044051643460989,-0.1870688647031784,0.16234560310840607,-0.03073088452219963,0.155042827129364,0.17713786661624908,-0.38114285469055176,-0.1938813030719757,0.17897172272205353,-0.06131156161427498,0.2386707365512848,0.08541231602430344,-0.1282764971256256,0.21118539571762085,-0.04039260745048523,0.079994335770607,-0.08648014068603516},{-0.1869715005159378,-0.007084268145263195,0.10595104098320007,0.3961544930934906,-0.3482559621334076,0.22868113219738007,-0.20538298785686493,-0.06331637501716614,-0.04387231916189194,0.35067909955978394,-0.028663640841841698,0.0848531648516655,-0.2702348530292511,0.45354124903678894,0.26968592405319214,0.1742113083600998,-0.418872207403183,-0.27359122037887573,0.029170291498303413,0.060631852596998215,0.39481571316719055,0.05187555402517319,-0.023154890164732933,-0.02524305135011673,0.27518555521965027,-0.08352887630462646,-0.2677733898162842,0.27814796566963196,0.2380484640598297,-0.10350771993398666,0.13586392998695374,0.005821188446134329}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.14921092987060547,-0.03394647315144539,0.19828514754772186,0.307320773601532},{-0.14765729010105133,0.15853387117385864,-0.12788432836532593,-0.17580391466617584},{0.014512604102492332,-0.3806530833244324,0.12416717410087585,0.3946641683578491},{0.4023350477218628,0.2884922921657562,-0.18807318806648254,-0.3008634150028229},{-0.0030238276813179255,-0.17632868885993958,-0.15162880718708038,0.06013604253530502},{0.22126299142837524,-0.21109111607074738,-0.033881451934576035,-0.17742329835891724},{0.13899144530296326,-0.062499117106199265,0.003000435419380665,-0.10182178765535355},{0.1928045153617859,-0.3376479148864746,0.02308722957968712,-0.11754339933395386},{-0.21921290457248688,0.2026197463274002,0.038582999259233475,-0.027007130905985832},{-0.16251687705516815,0.003154387231916189,-0.3285941779613495,0.01319277286529541},{0.035902708768844604,-0.06216251850128174,0.32829833030700684,0.047110363841056824},{0.07500432431697845,-0.2200492024421692,0.09273819625377655,0.539750874042511},{-0.05007590353488922,-0.3816557228565216,0.2866973280906677,0.2762155532836914},{0.036535073071718216,0.565462052822113,0.08770762383937836,0.1439746618270874},{0.2236425131559372,-0.11226388812065125,0.19689789414405823,-0.06939513981342316},{0.15929445624351501,-0.06346026062965393,0.1965656578540802,-0.2996605634689331},{-0.0575210303068161,0.019717667251825333,-0.18579085171222687,0.28222206234931946},{0.36104851961135864,-0.39329418540000916,-0.2171604484319687,-0.2498330920934677},{-0.21093536913394928,0.033673521131277084,-0.04354952648282051,0.12500277161598206},{-0.23116084933280945,0.03588153421878815,0.3155681788921356,0.12303483486175537},{0.2933182120323181,0.3574076294898987,-0.19789202511310577,0.12692813575267792},{-0.09533217549324036,0.18021142482757568,-0.1221034824848175,-0.22038088738918304},{-0.005528343375772238,-0.133926123380661,-0.10894658416509628,-0.1653752326965332},{-0.3682636618614197,-0.05113867297768593,0.16992159187793732,0.22920067608356476},{-0.33320942521095276,0.13898205757141113,-0.27089551091194153,-0.30179110169410706},{-0.35179850459098816,0.000636366952676326,-0.17746609449386597,-0.1251995712518692},{0.2473617047071457,-0.2102666050195694,-0.12321626394987106,-0.17922504246234894},{0.13390903174877167,-0.06765355169773102,0.44224950671195984,0.07194460928440094},{-0.24823367595672607,0.10895340889692307,0.05069680139422417,-0.16247840225696564},{0.08730766177177429,0.08494550734758377,0.20056970417499542,-0.0759408101439476},{0.10697536170482635,0.34631916880607605,0.4485290050506592,0.1760244518518448},{-0.28045082092285156,0.20192381739616394,-0.41327959299087524,-0.11593469977378845}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.26289618015289307,0.10508207976818085,-0.031014038249850273,0.11806268990039825,0.07627365738153458,0.3337174952030182,0.29569658637046814,0.13612361252307892};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {-0.12448664754629135,0.29047200083732605,0.05008436739444733,0.19515034556388855,0.1967567801475525,-0.051993478089571,0.1853872537612915,0.1825409233570099};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.10594189912080765,0.13111381232738495,0.2556964159011841,0.1076640784740448,0.21008120477199554,-0.3425554931163788,0.1663607954978943,-0.16064561903476715,0.20466238260269165,0.03853846341371536,0.1326124221086502,-0.08438795059919357,-0.11811986565589905,0.11004453152418137,-0.020522059872746468,-0.4082850217819214};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.22803206741809845,0.07228226214647293,0.19140146672725677,0.11185378581285477,-0.2276783436536789,0.10936661064624786,0.18916204571723938,0.11423534154891968,0.15396837890148163,-0.5262419581413269,0.2583760917186737,-0.14349044859409332,0.08394543826580048,-0.1217927485704422,0.15729813277721405,-0.030873842537403107};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05834797024726868,-0.06533753871917725,-0.0036042402498424053,0.08131527900695801,0.02414935827255249,0.031696464866399765,-0.006771141197532415,0.1679222732782364,-0.1052170917391777,-0.043798577040433884,0.14990781247615814,0.16203279793262482,0.07361716032028198,0.09029342234134674,0.055774055421352386,0.22206465899944305,0.1207592636346817,0.12316183000802994,-0.23527278006076813,0.09810440242290497,0.03454001247882843,-0.26727840304374695,0.05736329406499863,-0.09735351800918579,0.1496526002883911,-0.031371165066957474,-0.04036497324705124,0.026664962992072105,0.18575438857078552,-0.2407248169183731,0.059190694242715836,0.12196315079927444};
static const float action_parameterization_distribution_linear_bias[4] = {0.05374455824494362,0.0002308706025360152,-0.03583519533276558,-0.029136192053556442};



void networkEvaluate(struct control_t_n *control_n, const float *state_array) {

  
      ///////////////////////////////// NEIGHBOR OUTPUT CALCULATION ///////////////////////////////////////////
      float meanNeighbArr[8];
      meanNeighbArr[0] = 0.0f;
      meanNeighbArr[1] = 0.0f;
      meanNeighbArr[2] = 0.0f;
      meanNeighbArr[3] = 0.0f;
      meanNeighbArr[4] = 0.0f;
      meanNeighbArr[5] = 0.0f;
      meanNeighbArr[6] = 0.0f;
      meanNeighbArr[7] = 0.0f;

        for(int k = 0; k < NEIGHBORS; k++)
        {
          for (int i = 0; i < structure[0][1]; i++) {
              output_0[i] = 0;
              for (int j = 0; j < structure[0][0]; j++) {
                output_0[i] += kNearestArr[k][j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i];
              }
              output_0[i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
              //output_0[i] = tanhf(output_0[i]);
              output_0[i] = (output_0[i] < 0.0f) ? 0.0f : output_0[i];
          }
      
          for (int i = 0; i < structure[1][1]; i++) {
              output_1[i] = 0;
              for (int j = 0; j < structure[1][0]; j++) {
                  output_1[i] += output_0[j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
              }
              output_1[i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
              //output_1[i] = tanhf(output_1[i]);
              output_1[i] = (output_1[i] < 0.0f) ? 0.0f : output_1[i];
          }


          meanNeighbArr[0] = meanNeighbArr[0]+output_1[0];
          meanNeighbArr[1] = meanNeighbArr[1]+output_1[1];
          meanNeighbArr[2] = meanNeighbArr[2]+output_1[2];
          meanNeighbArr[3] = meanNeighbArr[3]+output_1[3];
          meanNeighbArr[4] = meanNeighbArr[4]+output_1[4];
          meanNeighbArr[5] = meanNeighbArr[5]+output_1[5];
          meanNeighbArr[6] = meanNeighbArr[6]+output_1[6];
          meanNeighbArr[7] = meanNeighbArr[7]+output_1[7];


        } 

        meanNeighbArr[0] /= NEIGHBORS;
        meanNeighbArr[1] /= NEIGHBORS;
        meanNeighbArr[2] /= NEIGHBORS;
        meanNeighbArr[3] /= NEIGHBORS;
        meanNeighbArr[4] /= NEIGHBORS;
        meanNeighbArr[5] /= NEIGHBORS;
        meanNeighbArr[6] /= NEIGHBORS;
        meanNeighbArr[7] /= NEIGHBORS;

          /////////////////// SELF_OUTPUT ///////////////////////////////////////////////////////////////////
          for (int i = 0; i < structure[2][1]; i++) {
              output_2[i] = 0;
              for (int j = 0; j < structure[2][0]; j++) {
                  output_2[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
              }
              output_2[i] += actor_encoder_self_encoder_0_bias[i];
              //output_2[i] = tanhf(output_2[i]);
              output_2[i] = (output_2[i] < 0.0f) ? 0.0f : output_2[i];

          }
          
          for (int i = 0; i < structure[3][1]; i++) {
              output_3[i] = 0;
              for (int j = 0; j < structure[3][0]; j++) {
                  output_3[i] += output_2[j] * actor_encoder_self_encoder_2_weight[j][i];
              }
              output_3[i] += actor_encoder_self_encoder_2_bias[i];
              //output_3[i] = tanhf(output_3[i]);
              output_3[i] = (output_3[i] < 0.0f) ? 0.0f : output_3[i];
          }
          

          ////////////////////////////////////////////////////// FEED FORWARD /////////////////////////////////////////////

          for(int k = 0; k < structure[3][1]; k++ )
          {
            inputff[k] = output_3[k];
          }

          for(int k = 0; k < structure[1][1]; k++ )
          {
            inputff[k+16] = meanNeighbArr[k];
          }

          for (int i = 0; i < structure[4][1]; i++) {
              output_4[i] = 0;
              for (int j = 0; j < structure[4][0]; j++) {
                  output_4[i] += inputff[j] * actor_encoder_feed_forward_0_weight[j][i];
              }
              output_4[i] += actor_encoder_feed_forward_0_bias[i];
              //output_4[i] = tanhf(output_4[i]);
              output_4[i] = (output_4[i] < 0.0f) ? 0.0f : output_4[i];
          }
          
          for (int i = 0; i < structure[5][1]; i++) {
              output_5[i] = 0;
              for (int j = 0; j < structure[5][0]; j++) {
                  output_5[i] += output_4[j] * action_parameterization_distribution_linear_weight[j][i];
              }
              output_5[i] += action_parameterization_distribution_linear_bias[i];
          }
        control_n->thrust_0 = output_5[0];
        control_n->thrust_1 = output_5[1];
        control_n->thrust_2 = output_5[2];
        control_n->thrust_3 = output_5[3];	
    }

int main_nn(float *outdatav)
{
    control_t_n motorThrusts;
    
    point_t pt;
    estimatorKalmanGetEstimatedPos(&pt);

    ///////////////////////////////////////////// update k nearest information
    float ownX = pt.x;
    float ownY = pt.y;
    float ownZ = pt.z;

    float farX = kNearestArr[farthestNeighb][0];
    float farY = kNearestArr[farthestNeighb][1];
    float farZ = kNearestArr[farthestNeighb][2];

    float lastX = dronesInfo[lastAdded][0];
    float lastY = dronesInfo[lastAdded][1];
    float lastZ = dronesInfo[lastAdded][2];

    float distFarX = (farX-ownX)*(farX-ownX);
    float distFarY = (farY-ownY)*(farY-ownY);
    float distFarZ = (farZ-ownZ)*(farZ-ownZ);

    float distLastX = (lastX-ownX)*(lastX-ownX);
    float distLastY = (lastY-ownY)*(lastY-ownY);
    float distLastZ = (lastZ-ownZ)*(lastZ-ownZ);

    float distFar  = sqrtf(distFarX  + distFarY  + distFarZ);
    float distLast = sqrtf(distLastX + distLastY + distLastZ);



    if(distLast < distFar) // if last added information is closer than farthest k nearest neighbor, update
    {

      // update infrmation
      kNearestArr[farthestNeighb][0] = dronesInfo[farthestNeighb][0];
      kNearestArr[farthestNeighb][1] = dronesInfo[farthestNeighb][1];
      kNearestArr[farthestNeighb][2] = dronesInfo[farthestNeighb][2];

      farthestNeighb = 0; // set new farthest neighbor to calcuate index of farthest neighbor

      // calculate distance to k nearest at index 0
      farX = kNearestArr[farthestNeighb][0];
      farY = kNearestArr[farthestNeighb][1];
      farZ = kNearestArr[farthestNeighb][2];

      distFarX = (farX-ownX)*(farX-ownX);
      distFarY = (farY-ownY)*(farY-ownY);
      distFarZ = (farZ-ownZ)*(farZ-ownZ);

      distFar  = sqrtf(distFarX  + distFarY  + distFarZ);

      for(int k = 1; k < NEIGHBORS; k++) // iteratio over all k nearest to compare distance
      {
        if(distFar < sqrtf((kNearestArr[k][0]-ownX)*(kNearestArr[k][0]-ownX)  + 
                           (kNearestArr[k][1]-ownY)*(kNearestArr[k][1]-ownY)  + 
                           (kNearestArr[k][2]-ownZ)*(kNearestArr[k][2]-ownZ))) // if k is nearest than farthest, change farthest
        {
          farthestNeighb = k;

          farX = kNearestArr[farthestNeighb][0];
          farY = kNearestArr[farthestNeighb][1];
          farZ = kNearestArr[farthestNeighb][2];

          distFarX = (farX-ownX)*(farX-ownX);
          distFarY = (farY-ownY)*(farY-ownY);
          distFarZ = (farZ-ownZ)*(farZ-ownZ);

          distFar  = sqrtf(distFarX  + distFarY  + distFarZ);

        }
        
      }

    }

  
  for(int k = 0; k < NGHBRS; k++)
  {
    kNearestArr[k][0] =  clip(kNearestArr[k][0], -10.0f, 10.0f);
    kNearestArr[k][1] =  clip(kNearestArr[k][1], -10.0f, 10.0f);
    kNearestArr[k][2] =  clip(kNearestArr[k][2], -10.0f, 10.0f);

    kNearestArr[k][3] =  clip(kNearestArr[k][3], -6.0f, 6.0f);
    kNearestArr[k][4] =  clip(kNearestArr[k][4], -6.0f, 6.0f);
    kNearestArr[k][5] =  clip(kNearestArr[k][5], -6.0f, 6.0f);

  }
  //////////////////////////////////////////////////////// get self information
  state_t ownState = getOwnState();

    // Orientation
	struct quat q = mkquat(ownState.attitudeQuaternion.x, 
						             ownState.attitudeQuaternion.y, 
						             ownState.attitudeQuaternion.z, 
						             ownState.attitudeQuaternion.w);

	rot = quat2rotmat(q);
  
	// angular velocity
  sensorData_t sensors = getSensorData();
	float omega_roll  = radians(sensors.gyro.x);
	float omega_pitch = radians(sensors.gyro.y);
	float omega_yaw   = radians(sensors.gyro.z);

	// the state vector
	state_array[0] = ownState.position.x - ownTarget[0];
	state_array[1] = ownState.position.y - ownTarget[1];
	state_array[2] = ownState.position.z - ownTarget[2];
	state_array[3] = ownState.velocity.x;
	state_array[4] = ownState.velocity.y;
	state_array[5] = ownState.velocity.z;
	state_array[6] = rot.m[0][0];
	state_array[7] = rot.m[0][1];
	state_array[8] = rot.m[0][2];
	state_array[9] = rot.m[1][0];
	state_array[10] = rot.m[1][1];
	state_array[11] = rot.m[1][2];
	state_array[12] = rot.m[2][0];
	state_array[13] = rot.m[2][1];
	state_array[14] = rot.m[2][2];
	state_array[15] = omega_roll;
	state_array[16] = omega_pitch;
	state_array[17] = omega_yaw;


state_array[0]  = clip(state_array[0] , -10.0f, 10.0f);
state_array[1]  = clip(state_array[1] , -10.0f, 10.0f);
state_array[2]  = clip(state_array[2] , -10.0f, 10.0f);
state_array[3]  = clip(state_array[3] , -3.0f, 3.0f);
state_array[4]  = clip(state_array[4] , -3.0f, 3.0f);
state_array[5]  = clip(state_array[5] , -3.0f, 3.0f);
state_array[6]  = clip(state_array[6] , -1.0f, 1.0f);
state_array[7]  = clip(state_array[7] , -1.0f, 1.0f);
state_array[8]  = clip(state_array[8] , -1.0f, 1.0f);
state_array[9]  = clip(state_array[9] , -1.0f, 1.0f);
state_array[10] = clip(state_array[10], -1.0f, 1.0f);
state_array[11] = clip(state_array[11], -1.0f, 1.0f);
state_array[12] = clip(state_array[12], -1.0f, 1.0f);
state_array[13] = clip(state_array[13], -1.0f, 1.0f);
state_array[14] = clip(state_array[14], -1.0f, 1.0f);
state_array[15] = clip(state_array[15], -40.0f, 40.0f);
state_array[16] = clip(state_array[16], -40.0f, 40.0f);
state_array[17] = clip(state_array[17], -40.0f, 40.0f);



  networkEvaluate(&motorThrusts, state_array);

  outdatav[0] = motorThrusts.thrust_0;
  outdatav[1] = motorThrusts.thrust_1;
  outdatav[2] = motorThrusts.thrust_2;
  outdatav[3] = motorThrusts.thrust_3;
    
  return 1;
}

float clip(float val, float min, float max)
{
  if(val < min)
      {
        return min;
      }
      else if(val > max)
      {
        return max;
      }
      else
      {
        return val;
      }
}



void communicate()
{
  if (timer == ownPacket.id)
  {
    ownPacket.pos = getPosition();
    ownPacket.vel = getVeloc();
    P2PPacket packet;
    packet.port = 0;
    packet.size = sizeof(PacketData);
    memcpy(packet.data, &ownPacket, sizeof(PacketData));
    radiolinkSendP2PPacketBroadcast(&packet);
  }
}

void p2pcallbackHandler(P2PPacket *p)
{
    PacketData received;
    memcpy(&received, p->data, sizeof(PacketData));
    lastAdded = received.id;
    
    dronesInfo[received.id][0] = received.pos.x;
    dronesInfo[received.id][1] = received.pos.x;
    dronesInfo[received.id][2] = received.pos.y;
    
    dronesInfo[received.id][3] = received.vel.x;
    dronesInfo[received.id][4] = received.vel.y;
    dronesInfo[received.id][5] = received.vel.z;

}


Vector3 getPosition(void)
{
    point_t pt;
    estimatorKalmanGetEstimatedPos(&pt);
    return (Vector3){.x = pt.x, .y=pt.y, .z=pt.z};
} 

Vector3 getVeloc(void)
{
    return getVelocity();
}

uint8_t isHighLevel()
{
  return highlvl;

}

void  getThrusts(uint16_t* trsts)
{
  trsts[0] = thrustsToMotor[0];
  trsts[1] = thrustsToMotor[1];
  trsts[2] = thrustsToMotor[2];
  trsts[3] = thrustsToMotor[3];
}

void appMain() { 
  	// control->enableDirectThrust = true; // in the code of quadswarms they use this, why? (seems they changed the firmware)
  vTaskDelay(M2T(10000));
  p2pRegisterCB(p2pcallbackHandler);

  uint64_t address = configblockGetRadioAddress();
  uint8_t my_id    = (uint8_t)((address) & 0x00000000ff);
  ownPacket.id     = my_id;
  point_t ownPosition;
  estimatorKalmanGetEstimatedPos(&ownPosition);

  Vector3 ownVeloc = getVeloc();

  for(int k = 0; k < NUMQUADS; k++)
  {
    dronesInfo[k][0] =  8.0f;
    dronesInfo[k][1] =  k*1.5f;
    dronesInfo[k][2] =  0.0f;

    dronesInfo[k][3] = 0.0f;
    dronesInfo[k][4] = 0.0f;
    dronesInfo[k][5] = 0.0f;

  }
  
  for(int k = 0; k < NGHBRS; k++)
  {
    kNearestArr[k][0]  = ownPosition.x - dronesInfo[k][0];
    kNearestArr[k][1]  = ownPosition.y - dronesInfo[k][1];
    kNearestArr[k][2]  = ownPosition.z - dronesInfo[k][2];

    kNearestArr[k][3]  = ownVeloc.x;
    kNearestArr[k][4]  = ownVeloc.y;
    kNearestArr[k][5]  = ownVeloc.z;
  }
    

  while(1) {

    vTaskDelay(M2T(1));
    estimatorKalmanGetEstimatedPos(&ownPosition);
    //communicate();
    timer++;
    if(timer >= NUMQUADS)
    {
      timer = 0;
    }

    switch (state)
    {
    case 0: // do nothing
      break;
    case 1: // start 
            
      for(int k = 0; k < 4; k++)
      {
        thrustsToMotor[k] = (uint16_t)(UINT16_MAX*thrusts[k]*(mototrKValue));
      }
      // motorsSetRatio(0, thrusts[1]);
      // motorsSetRatio(1, thrusts[2]);
      // motorsSetRatio(2, thrusts[3]);
      // motorsSetRatio(3, thrusts[0]);

      break;
    case 2: // land

      if(ownPosition.z < 0.15f)
      {
        for(int k = 0; k < 4; k++)
        {
            thrustsToMotor[k] = (uint16_t)(UINT16_MAX*(0.0f));
        }
        state = 0;
      }
      break;
    default:
      break;
    }
    main_nn(thrusts);
    
    for(int k = 0; k < 4; k++)
    {
      if(thrusts[k] < -1.0f)
      {
        thrusts[k] = -1.0f;
      }
      else if(thrusts[k] > 1.0f)
      {
        thrusts[k] = 1.0f;
      }

      thrusts[k] += 1.0f;
      thrusts[k] /= 2.0f;

      thrustsInt[k] = (uint16_t)(UINT16_MAX*thrusts[k]);

    }

  }
}



PARAM_GROUP_START(ctrlnn)
PARAM_ADD(PARAM_UINT8, stt,    &state)
PARAM_ADD(PARAM_UINT8, id,     &(ownPacket.id))
PARAM_ADD(PARAM_FLOAT, kVal, &mototrKValue)
PARAM_ADD(PARAM_FLOAT, targetx, &(ownTarget[0]))
PARAM_ADD(PARAM_FLOAT, targety, &(ownTarget[1]))
PARAM_ADD(PARAM_FLOAT, targetz, &(ownTarget[2]))
PARAM_GROUP_STOP(ctrlnn)




LOG_GROUP_START(logNN)         
LOG_ADD(LOG_INT16, id, &(ownPacket.id))

LOG_ADD(LOG_FLOAT, t0, &(thrusts[1]))
LOG_ADD(LOG_FLOAT, t1, &(thrusts[2]))
LOG_ADD(LOG_FLOAT, t2, &(thrusts[3]))
LOG_ADD(LOG_FLOAT, t3, &(thrusts[0]))

LOG_ADD(LOG_UINT16, tint0, &(thrustsInt[1]))
LOG_ADD(LOG_UINT16, tint1, &(thrustsInt[2]))
LOG_ADD(LOG_UINT16, tint2, &(thrustsInt[3]))
LOG_ADD(LOG_UINT16, tint3, &(thrustsInt[0]))

LOG_ADD(LOG_FLOAT, px, &(state_array[0]))
LOG_ADD(LOG_FLOAT, py, &(state_array[1]))
LOG_ADD(LOG_FLOAT, pz, &(state_array[2]))
LOG_ADD(LOG_FLOAT, vx, &(state_array[3]))
LOG_ADD(LOG_FLOAT, vy, &(state_array[4]))
LOG_ADD(LOG_FLOAT, vz, &(state_array[5]))

LOG_ADD(LOG_FLOAT, r0, &(state_array[6]))
LOG_ADD(LOG_FLOAT, r1, &(state_array[7]))
LOG_ADD(LOG_FLOAT, r2, &(state_array[8]))
LOG_ADD(LOG_FLOAT, r3, &(state_array[9]))
LOG_ADD(LOG_FLOAT, r4, &(state_array[10]))
LOG_ADD(LOG_FLOAT, r5, &(state_array[11]))
LOG_ADD(LOG_FLOAT, r6, &(state_array[12]))
LOG_ADD(LOG_FLOAT, r7, &(state_array[13]))
LOG_ADD(LOG_FLOAT, r8, &(state_array[14]))

LOG_ADD(LOG_FLOAT, wx, &(state_array[15]))
LOG_ADD(LOG_FLOAT, wy, &(state_array[16]))
LOG_ADD(LOG_FLOAT, wz, &(state_array[17]))

LOG_ADD(LOG_FLOAT, px0, &(kNearestArr[0][0]))
LOG_ADD(LOG_FLOAT, py0, &(kNearestArr[0][1]))
LOG_ADD(LOG_FLOAT, pz0, &(kNearestArr[0][2]))
LOG_ADD(LOG_FLOAT, vx0, &(kNearestArr[0][3]))
LOG_ADD(LOG_FLOAT, vy0, &(kNearestArr[0][4]))
LOG_ADD(LOG_FLOAT, vz0, &(kNearestArr[0][5]))

LOG_ADD(LOG_FLOAT, px1, &(kNearestArr[1][0]))
LOG_ADD(LOG_FLOAT, py1, &(kNearestArr[1][1]))
LOG_ADD(LOG_FLOAT, pz1, &(kNearestArr[1][2]))
LOG_ADD(LOG_FLOAT, vx1, &(kNearestArr[1][3]))
LOG_ADD(LOG_FLOAT, vy1, &(kNearestArr[1][4]))
LOG_ADD(LOG_FLOAT, vz1, &(kNearestArr[1][5]))

LOG_ADD(LOG_FLOAT, px2, &(kNearestArr[2][0]))
LOG_ADD(LOG_FLOAT, py2, &(kNearestArr[2][1]))
LOG_ADD(LOG_FLOAT, pz2, &(kNearestArr[2][2]))
LOG_ADD(LOG_FLOAT, vx2, &(kNearestArr[2][3]))
LOG_ADD(LOG_FLOAT, vy2, &(kNearestArr[2][4]))
LOG_ADD(LOG_FLOAT, vz2, &(kNearestArr[2][5]))

LOG_ADD(LOG_FLOAT, px3, &(kNearestArr[3][0]))
LOG_ADD(LOG_FLOAT, py3, &(kNearestArr[3][1]))
LOG_ADD(LOG_FLOAT, pz3, &(kNearestArr[3][2]))
LOG_ADD(LOG_FLOAT, vx3, &(kNearestArr[3][3]))
LOG_ADD(LOG_FLOAT, vy3, &(kNearestArr[3][4]))
LOG_ADD(LOG_FLOAT, vz3, &(kNearestArr[3][5]))

LOG_ADD(LOG_FLOAT, px4, &(kNearestArr[4][0]))
LOG_ADD(LOG_FLOAT, py4, &(kNearestArr[4][1]))
LOG_ADD(LOG_FLOAT, pz4, &(kNearestArr[4][2]))
LOG_ADD(LOG_FLOAT, vx4, &(kNearestArr[4][3]))
LOG_ADD(LOG_FLOAT, vy4, &(kNearestArr[4][4]))
LOG_ADD(LOG_FLOAT, vz4, &(kNearestArr[4][5]))

LOG_ADD(LOG_FLOAT, px5, &(kNearestArr[5][0]))
LOG_ADD(LOG_FLOAT, py5, &(kNearestArr[5][1]))
LOG_ADD(LOG_FLOAT, pz5, &(kNearestArr[5][2]))
LOG_ADD(LOG_FLOAT, vx5, &(kNearestArr[5][3]))
LOG_ADD(LOG_FLOAT, vy5, &(kNearestArr[5][4]))
LOG_ADD(LOG_FLOAT, vz5, &(kNearestArr[5][5]))

LOG_ADD(LOG_FLOAT, targetx, &(ownTarget[0]))
LOG_ADD(LOG_FLOAT, targety, &(ownTarget[1]))
LOG_ADD(LOG_FLOAT, targetz, &(ownTarget[2]))

LOG_ADD(LOG_FLOAT, out0_0, &(output_0[0]))
LOG_ADD(LOG_FLOAT, out0_1, &(output_0[1]))
LOG_ADD(LOG_FLOAT, out0_2, &(output_0[2]))
LOG_ADD(LOG_FLOAT, out0_3, &(output_0[3]))
LOG_ADD(LOG_FLOAT, out0_4, &(output_0[4]))
LOG_ADD(LOG_FLOAT, out0_5, &(output_0[5]))
LOG_ADD(LOG_FLOAT, out0_6, &(output_0[6]))
LOG_ADD(LOG_FLOAT, out0_7, &(output_0[7]))

LOG_ADD(LOG_FLOAT, out1_0, &(output_1[0]))
LOG_ADD(LOG_FLOAT, out1_1, &(output_1[1]))
LOG_ADD(LOG_FLOAT, out1_2, &(output_1[2]))
LOG_ADD(LOG_FLOAT, out1_3, &(output_1[3]))
LOG_ADD(LOG_FLOAT, out1_4, &(output_1[4]))
LOG_ADD(LOG_FLOAT, out1_5, &(output_1[5]))
LOG_ADD(LOG_FLOAT, out1_6, &(output_1[6]))
LOG_ADD(LOG_FLOAT, out1_7, &(output_1[7]))

LOG_ADD(LOG_FLOAT, out2_0, &(output_2[0]))
LOG_ADD(LOG_FLOAT, out2_1, &(output_2[1]))
LOG_ADD(LOG_FLOAT, out2_2, &(output_2[2]))
LOG_ADD(LOG_FLOAT, out2_3, &(output_2[3]))
LOG_ADD(LOG_FLOAT, out2_4, &(output_2[4]))
LOG_ADD(LOG_FLOAT, out2_5, &(output_2[5]))
LOG_ADD(LOG_FLOAT, out2_6, &(output_2[6]))
LOG_ADD(LOG_FLOAT, out2_7, &(output_2[7]))
LOG_ADD(LOG_FLOAT, out2_8, &(output_2[8]))
LOG_ADD(LOG_FLOAT, out2_9, &(output_2[9]))
LOG_ADD(LOG_FLOAT, out2_10, &(output_2[10]))
LOG_ADD(LOG_FLOAT, out2_11, &(output_2[11]))
LOG_ADD(LOG_FLOAT, out2_12, &(output_2[12]))
LOG_ADD(LOG_FLOAT, out2_13, &(output_2[13]))
LOG_ADD(LOG_FLOAT, out2_14, &(output_2[14]))
LOG_ADD(LOG_FLOAT, out2_15, &(output_2[15]))

LOG_ADD(LOG_FLOAT, out3_0, &(output_3[0]))
LOG_ADD(LOG_FLOAT, out3_1, &(output_3[1]))
LOG_ADD(LOG_FLOAT, out3_2, &(output_3[2]))
LOG_ADD(LOG_FLOAT, out3_3, &(output_3[3]))
LOG_ADD(LOG_FLOAT, out3_4, &(output_3[4]))
LOG_ADD(LOG_FLOAT, out3_5, &(output_3[5]))
LOG_ADD(LOG_FLOAT, out3_6, &(output_3[6]))
LOG_ADD(LOG_FLOAT, out3_7, &(output_3[7]))
LOG_ADD(LOG_FLOAT, out3_8, &(output_3[8]))
LOG_ADD(LOG_FLOAT, out3_9, &(output_3[9]))
LOG_ADD(LOG_FLOAT, out3_10, &(output_3[10]))
LOG_ADD(LOG_FLOAT, out3_11, &(output_3[11]))
LOG_ADD(LOG_FLOAT, out3_12, &(output_3[12]))
LOG_ADD(LOG_FLOAT, out3_13, &(output_3[13]))
LOG_ADD(LOG_FLOAT, out3_14, &(output_3[14]))
LOG_ADD(LOG_FLOAT, out3_15, &(output_3[15]))

LOG_ADD(LOG_FLOAT, out4_0,    &(output_4[0]))
LOG_ADD(LOG_FLOAT, out4_1,    &(output_4[1]))
LOG_ADD(LOG_FLOAT, out4_2,    &(output_4[2]))
LOG_ADD(LOG_FLOAT, out4_3,    &(output_4[3]))
LOG_ADD(LOG_FLOAT, out4_4,    &(output_4[4]))
LOG_ADD(LOG_FLOAT, out4_5,    &(output_4[5]))
LOG_ADD(LOG_FLOAT, out4_6,    &(output_4[6]))
LOG_ADD(LOG_FLOAT, out4_7,    &(output_4[7]))
LOG_ADD(LOG_FLOAT, out4_8,    &(output_4[8]))
LOG_ADD(LOG_FLOAT, out4_9,    &(output_4[9]))
LOG_ADD(LOG_FLOAT, out4_10,   &(output_4[10]))
LOG_ADD(LOG_FLOAT, out4_11,   &(output_4[11]))
LOG_ADD(LOG_FLOAT, out4_12,   &(output_4[12]))
LOG_ADD(LOG_FLOAT, out4_13,   &(output_4[13]))
LOG_ADD(LOG_FLOAT, out4_14,   &(output_4[14]))
LOG_ADD(LOG_FLOAT, out4_15,   &(output_4[15]))
LOG_ADD(LOG_FLOAT, out4_16,   &(output_4[16]))
LOG_ADD(LOG_FLOAT, out4_17,   &(output_4[17]))
LOG_ADD(LOG_FLOAT, out4_18,   &(output_4[18]))
LOG_ADD(LOG_FLOAT, out4_19,   &(output_4[19]))
LOG_ADD(LOG_FLOAT, out4_20,   &(output_4[20]))
LOG_ADD(LOG_FLOAT, out4_21,   &(output_4[21]))
LOG_ADD(LOG_FLOAT, out4_22,   &(output_4[22]))
LOG_ADD(LOG_FLOAT, out4_23,   &(output_4[23]))
LOG_ADD(LOG_FLOAT, out4_4,    &(output_4[24]))
LOG_ADD(LOG_FLOAT, out4_5,    &(output_4[25]))
LOG_ADD(LOG_FLOAT, out4_6,    &(output_4[26]))
LOG_ADD(LOG_FLOAT, out4_7,    &(output_4[27]))
LOG_ADD(LOG_FLOAT, out4_8,    &(output_4[28]))
LOG_ADD(LOG_FLOAT, out4_9,    &(output_4[29]))
LOG_ADD(LOG_FLOAT, out4_10,   &(output_4[30]))
LOG_ADD(LOG_FLOAT, out4_11,   &(output_4[31]))

LOG_ADD(LOG_FLOAT, inputff_0,    &(inputff[0]))
LOG_ADD(LOG_FLOAT, inputff_1,    &(inputff[1]))
LOG_ADD(LOG_FLOAT, inputff_2,    &(inputff[2]))
LOG_ADD(LOG_FLOAT, inputff_3,    &(inputff[3]))
LOG_ADD(LOG_FLOAT, inputff_4,    &(inputff[4]))
LOG_ADD(LOG_FLOAT, inputff_5,    &(inputff[5]))
LOG_ADD(LOG_FLOAT, inputff_6,    &(inputff[6]))
LOG_ADD(LOG_FLOAT, inputff_7,    &(inputff[7]))
LOG_ADD(LOG_FLOAT, inputff_8,    &(inputff[8]))
LOG_ADD(LOG_FLOAT, inputff_9,    &(inputff[9]))
LOG_ADD(LOG_FLOAT, inputff_10,   &(inputff[10]))
LOG_ADD(LOG_FLOAT, inputff_11,   &(inputff[11]))
LOG_ADD(LOG_FLOAT, inputff_12,   &(inputff[12]))
LOG_ADD(LOG_FLOAT, inputff_13,   &(inputff[13]))
LOG_ADD(LOG_FLOAT, inputff_14,   &(inputff[14]))
LOG_ADD(LOG_FLOAT, inputff_15,   &(inputff[15]))
LOG_ADD(LOG_FLOAT, inputff_16,   &(inputff[16]))
LOG_ADD(LOG_FLOAT, inputff_17,   &(inputff[17]))
LOG_ADD(LOG_FLOAT, inputff_18,   &(inputff[18]))
LOG_ADD(LOG_FLOAT, inputff_19,   &(inputff[19]))
LOG_ADD(LOG_FLOAT, inputff_20,   &(inputff[20]))
LOG_ADD(LOG_FLOAT, inputff_21,   &(inputff[21]))
LOG_ADD(LOG_FLOAT, inputff_22,   &(inputff[22]))
LOG_ADD(LOG_FLOAT, inputff_23,   &(inputff[23]))


LOG_ADD(LOG_FLOAT, out5_0,  &(output_5[0]))
LOG_ADD(LOG_FLOAT, out5_1,  &(output_5[1]))
LOG_ADD(LOG_FLOAT, out5_2,  &(output_5[2]))
LOG_ADD(LOG_FLOAT, out5_3,  &(output_5[3]))

LOG_GROUP_STOP(logNN)



